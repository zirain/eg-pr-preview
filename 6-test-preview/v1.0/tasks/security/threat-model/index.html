<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/eg-pr-preview/6-test-preview/favicons/favicon.ico><link rel=apple-touch-icon href=/eg-pr-preview/6-test-preview/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/eg-pr-preview/6-test-preview/favicons/android-192x192.png sizes=192x192><title>Threat Model | Envoy Gateway</title>
<meta name=description content="Envoy Gateway Threat Model and End User Recommendations About This work was performed by ControlPlane and commissioned by the Linux Foundation. ControlPlane is a global cloud native and open source cybersecurity consultancy, trusted as the partner of choice in securing: multinational banks; major public clouds; international financial institutions; critical national infrastructure programs; multinational oil and gas companies, healthcare and insurance providers; and global media firms.
Threat Modelling Team James Callaghan, Torin van den Bulk, Eduardo Olarte"><meta property="og:url" content="https://zirain.github.io/eg-pr-preview/6-test-preview/v1.0/tasks/security/threat-model/"><meta property="og:site_name" content="Envoy Gateway"><meta property="og:title" content="Threat Model"><meta property="og:description" content="Envoy Gateway Threat Model and End User Recommendations About This work was performed by ControlPlane and commissioned by the Linux Foundation. ControlPlane is a global cloud native and open source cybersecurity consultancy, trusted as the partner of choice in securing: multinational banks; major public clouds; international financial institutions; critical national infrastructure programs; multinational oil and gas companies, healthcare and insurance providers; and global media firms.
Threat Modelling Team James Callaghan, Torin van den Bulk, Eduardo Olarte"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="v1.0"><meta property="article:modified_time" content="2025-01-14T19:35:21+08:00"><meta itemprop=name content="Threat Model"><meta itemprop=description content="Envoy Gateway Threat Model and End User Recommendations About This work was performed by ControlPlane and commissioned by the Linux Foundation. ControlPlane is a global cloud native and open source cybersecurity consultancy, trusted as the partner of choice in securing: multinational banks; major public clouds; international financial institutions; critical national infrastructure programs; multinational oil and gas companies, healthcare and insurance providers; and global media firms.
Threat Modelling Team James Callaghan, Torin van den Bulk, Eduardo Olarte"><meta itemprop=dateModified content="2025-01-14T19:35:21+08:00"><meta itemprop=wordCount content="10909"><meta name=twitter:card content="summary"><meta name=twitter:title content="Threat Model"><meta name=twitter:description content="Envoy Gateway Threat Model and End User Recommendations About This work was performed by ControlPlane and commissioned by the Linux Foundation. ControlPlane is a global cloud native and open source cybersecurity consultancy, trusted as the partner of choice in securing: multinational banks; major public clouds; international financial institutions; critical national infrastructure programs; multinational oil and gas companies, healthcare and insurance providers; and global media firms.
Threat Modelling Team James Callaghan, Torin van den Bulk, Eduardo Olarte"><link rel=preload href=/eg-pr-preview/6-test-preview/scss/main.min.13dd8d11b772c2d11eac755eb5d2d8924f18f01762c20defa026366a1f00937d.css as=style><link href=/eg-pr-preview/6-test-preview/scss/main.min.13dd8d11b772c2d11eac755eb5d2d8924f18f01762c20defa026366a1f00937d.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DXJEH1ZRXX"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DXJEH1ZRXX")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/eg-pr-preview/6-test-preview/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 1200 400"><defs><style>.cls-1{fill:#d04c9b}.cls-2{fill:#4a2365}.cls-3{fill:#b96aab}.cls-4{isolation:isolate}.cls-5{fill:#a53995}</style></defs><g><g id="Layer_1"><g><polygon id="polygon20" class="cls-5" points="191.2 242.29 190.55 213 159.76 193.83 160.4 223.12 191.2 242.29"/><path id="path22" class="cls-5" d="M234.92 315.52l-.65-28.65-26.92-16.8c-.43-.21-.86-.64-1.08-.86l.65 28.86 28 17.45h0z"/><path id="path24" class="cls-5" d="M138.65 354.07l-70.42-43.72-1.73-73.23 34.46-14.86-.65-29.29-55.14 23.69c-4.3 1.94-6.89 5.81-6.67 10.33l2.15 87.87c0 4.53 2.8 9.06 7.11 11.64l84.43 52.33c3.88 2.37 8.61 3.02 12.71 1.94.43-.21.86-.21 1.29-.43l51.9-22.39-28.21-17.45-31.23 13.57h0z"/><path id="path26" class="cls-3" d="M366.29 192.11c-.21-5.17-3.23-10.55-8.39-13.57l-102.52-63.53-3.23 1.29.64 30.8 81.19 50.4 1.94 82.27 31.01 19.17 1.72-.64-2.37-106.18h0z"/><path id="path28" class="cls-3" d="M243.53 336.62l-95.41-59.01-2.37-99.07 43.51-18.74-.86-34.24-67.41 29.07c-4.95 2.16-7.97 6.68-7.75 12.06l2.8 116.3c0 5.38 3.23 10.56 8.4 13.57l111.78 69.35c4.52 2.79 10.12 3.66 14.86 2.15.43-.22.86-.43 1.29-.43l65.9-28.44-32.73-20.25-42 17.67h0z"/><path id="path30" class="cls-1" d="M511.67 110.69 368.45 21.96c-5.38-3.23-11.62-4.1-17-2.37-.44.21-1.08.43-1.51.64L210.16 80.54c-5.6 2.37-9.04 7.54-8.83 13.78l3.44 149.04c.22 6.03 3.88 12.06 9.7 15.51l143.22 88.73c5.17 3.23 11.63 4.09 17.01 2.38.43-.22 1.08-.44 1.51-.65l139.78-60.3c5.59-2.37 9.05-7.75 8.84-13.79l-3.45-149.04c-.21-6.03-3.88-11.85-9.69-15.51M366.08 314.22 241.6 237.11l-3.02-129.44 121.47-52.33 124.49 77.1 3.02 129.45-121.47 52.33h0z"/></g><path id="path10" class="cls-2" d="M607.46 182.14c0 4.62 1.08 9.04 3.23 12.83 2.16 3.78 4.95 7.15 8.18 9.88 3.44 2.74 7.33 4.84 11.84 6.32 4.52 1.47 9.26 2.31 14 2.31 6.46.0 12.27-1.48 17.01-4.41 4.73-2.96 9.26-6.96 13.35-11.79L691 209.07c-11.63 14.71-27.99 22.08-48.88 22.08-8.61.0-16.58-1.47-23.69-4.41-7.11-2.96-13.13-6.95-17.88-12-4.95-5.05-8.61-11.15-11.19-17.88-2.58-6.94-3.88-14.31-3.88-22.51s1.51-15.57 4.31-22.51 6.89-12.83 11.84-17.88 10.98-9.04 18.09-12c6.9-2.94 14.65-4.42 22.83-4.42 9.69.0 18.09 1.69 24.77 5.06 6.67 3.36 12.27 7.77 16.58 13.03 4.31 5.48 7.54 11.37 9.48 18.31 1.94 6.73 3.01 13.67 3.01 20.62v7.37h-88.93v.21h0zM673.78 165.95c-.22-4.63-.86-8.64-2.15-12.42-1.29-3.79-3.23-7.15-6.03-9.89-2.59-2.74-6.02-5.05-9.91-6.53-3.88-1.69-8.61-2.31-13.78-2.31s-9.9 1.05-13.99 2.94c-4.31 1.88-7.97 4.42-10.77 7.36-3.01 2.94-5.17 6.31-6.89 10.1s-2.37 7.37-2.37 10.95h65.89v-.21h0z"/><path id="path12" class="cls-2" d="M714.26 120.71h20.89v16.61h.43c2.58-5.68 7.32-10.52 13.78-13.88 6.46-3.58 14-5.26 22.61-5.26 5.39.0 10.34.84 15.29 2.31 4.95 1.68 9.26 4.01 12.71 7.36 3.66 3.37 6.46 7.57 8.83 12.84 2.16 5.26 3.23 11.36 3.23 18.51v69.44h-20.89v-63.76c0-5.05-.65-9.25-2.15-12.83-1.3-3.58-3.23-6.53-5.6-8.64-2.37-2.1-4.95-3.79-7.97-4.83-3.01-1.06-6.24-1.48-9.47-1.48-4.3.0-8.4.63-12.06 2.1-3.66 1.48-6.89 3.58-9.68 6.53-2.8 2.94-4.96 6.73-6.47 11.35-1.5 4.63-2.37 9.89-2.37 16.21v55.55h-20.88V120.69h-.22v.02z"/><polygon id="polygon14" class="cls-2" points="843.03 120.71 875.98 203.4 907.63 120.71 930.03 120.71 886.74 228.64 863.71 228.64 818.7 120.71 843.03 120.71"/><path id="path16" class="cls-2" d="M931.53 174.77c0-7.78 1.51-15.15 4.53-22.09 3.01-6.73 7.1-12.83 12.49-17.88 5.38-5.06 11.41-9.26 18.73-12.2 7.12-2.95 14.86-4.42 23.04-4.42s15.93 1.47 23.04 4.42c7.1 2.94 13.36 6.93 18.73 12.2 5.17 5.25 9.48 11.15 12.5 17.88 3.01 6.73 4.53 14.1 4.53 22.09s-1.52 15.36-4.53 22.1c-3.02 6.94-7.11 12.83-12.5 17.88-5.37 5.05-11.4 9.04-18.73 12-7.11 2.94-14.85 4.41-23.04 4.41s-15.93-1.47-23.04-4.41c-7.1-2.96-13.35-6.95-18.73-12-5.39-5.05-9.48-11.15-12.49-17.88-3.01-6.94-4.53-14.31-4.53-22.1M953.71 174.77c0 5.47.86 10.52 2.59 15.15 1.71 4.62 4.09 8.62 7.31 11.79 3.02 3.37 6.9 5.89 11.42 7.78 4.52 1.89 9.48 2.94 15.08 2.94s10.55-.84 15.07-2.94c4.51-1.89 8.4-4.41 11.42-7.78 3-3.16 5.59-7.16 7.31-11.79 1.73-4.63 2.59-9.68 2.59-15.15s-.86-10.52-2.59-15.15c-1.71-4.63-4.09-8.63-7.31-11.78-3.02-3.15-6.9-5.89-11.42-7.78-4.52-1.89-9.48-2.94-15.07-2.94s-10.56 1.05-15.08 2.94c-4.52 1.9-8.39 4.42-11.42 7.78-3 3.37-5.59 7.15-7.31 11.78-1.73 4.63-2.59 9.68-2.59 15.15"/><path id="path18" class="cls-2" d="M1050.39 120.71h24.12l32.74 84.15h.42l31.44-84.15h22.4l-52.32 131.07c-1.94 4.63-3.88 9.05-5.82 12.84s-4.31 7.15-7.11 9.88c-2.79 2.73-6.25 4.84-10.12 6.31-3.88 1.48-8.82 2.31-14.43 2.31-3.02.0-6.24-.21-9.48-.62-3.22-.41-6.25-1.26-9.25-2.31l2.58-18.74c4.09 1.69 8.4 2.53 12.49 2.53 3.24.0 6.03-.42 8.18-1.26 2.16-.84 4.09-2.1 5.81-3.58 1.73-1.69 3.03-3.36 4.09-5.46 1.08-2.12 2.15-4.63 3.23-7.37l6.88-17.04-45.86-108.56h0z"/><g class="cls-4"><path class="cls-5" d="M636.86 328.23c0 8.4-2.15 14.77-6.44 19.14-4.3 4.36-10.51 6.54-18.65 6.54-4.53.0-8.61-.66-12.25-1.97s-7.1-3.58-10.38-6.79l5.51-6.3c2.43 2.62 5 4.61 7.72 5.95s5.85 2.02 9.4 2.02 6.25-.51 8.51-1.52c2.26-1.02 4.05-2.4 5.36-4.13 1.31-1.74 2.23-3.72 2.75-5.95.52-2.23.79-4.56.79-6.99v-5.9h-.2c-1.84 2.95-4.23 5.12-7.18 6.49-2.95 1.38-5.97 2.07-9.05 2.07-3.61.0-6.92-.59-9.94-1.77-3.02-1.18-5.61-2.82-7.77-4.92s-3.84-4.59-5.02-7.48c-1.18-2.89-1.77-6.03-1.77-9.45.0-3.74.59-7.12 1.77-10.13 1.18-3.02 2.84-5.56 4.97-7.62 2.13-2.07 4.71-3.66 7.72-4.77 3.02-1.11 6.36-1.67 10.04-1.67 1.57.0 3.15.18 4.72.54s3.1.92 4.58 1.67 2.8 1.71 3.98 2.85c1.18 1.15 2.17 2.48 2.95 3.98h.2v-7.87h7.67v43.98zm-40.34-20.95c0 2.36.43 4.54 1.28 6.54s2.02 3.74 3.49 5.21c1.48 1.48 3.2 2.64 5.17 3.49 1.97.85 4.07 1.28 6.3 1.28 2.62.0 4.95-.46 6.99-1.38 2.03-.92 3.75-2.15 5.17-3.69 1.41-1.54 2.48-3.31 3.2-5.31s1.08-4.12 1.08-6.35c0-2.49-.39-4.77-1.18-6.84s-1.9-3.85-3.34-5.36-3.18-2.67-5.21-3.49c-2.03-.82-4.26-1.23-6.69-1.23s-4.64.44-6.64 1.33c-2 .88-3.71 2.1-5.12 3.64-1.41 1.54-2.51 3.35-3.3 5.41-.79 2.07-1.18 4.31-1.18 6.74z"/><path class="cls-5" d="M650.44 290.16c2.36-2.43 5.17-4.21 8.41-5.36 3.25-1.15 6.54-1.72 9.89-1.72 6.82.0 11.74 1.61 14.76 4.82s4.53 8.1 4.53 14.66v19.78c0 1.31.06 2.67.2 4.08.13 1.41.3 2.71.49 3.89h-7.38c-.26-1.05-.41-2.21-.44-3.49-.03-1.28-.05-2.41-.05-3.39h-.2c-1.51 2.36-3.53 4.3-6.05 5.81-2.53 1.51-5.56 2.26-9.1 2.26-2.36.0-4.58-.29-6.64-.89-2.07-.59-3.87-1.46-5.41-2.61-1.54-1.15-2.77-2.57-3.69-4.28-.92-1.71-1.38-3.67-1.38-5.9.0-3.8.98-6.79 2.95-8.95 1.97-2.16 4.41-3.77 7.33-4.82 2.92-1.05 6.07-1.7 9.45-1.97 3.38-.26 6.48-.39 9.3-.39h2.95v-1.38c0-3.35-1-5.87-3-7.58s-4.81-2.56-8.41-2.56c-2.49.0-4.94.41-7.33 1.23-2.4.82-4.51 2.08-6.35 3.79l-4.82-5.02zM672.67 308.16c-4.92.0-8.82.69-11.71 2.07s-4.33 3.64-4.33 6.79c0 2.89.97 4.94 2.9 6.15s4.34 1.82 7.23 1.82c2.23.0 4.18-.38 5.85-1.13 1.67-.75 3.07-1.75 4.18-3 1.12-1.25 1.97-2.71 2.56-4.38.59-1.67.92-3.46.98-5.36v-2.95h-7.67z"/><path class="cls-5" d="M727.28 290.75H713.7v23.02c0 1.51.03 2.9.1 4.18.06 1.28.33 2.39.79 3.34.46.95 1.15 1.71 2.07 2.26.92.56 2.23.84 3.94.84 1.11.0 2.26-.13 3.44-.39 1.18-.26 2.3-.66 3.35-1.18l.29 6.99c-1.31.59-2.77 1.02-4.38 1.28s-3.13.39-4.58.39c-2.75.0-4.95-.36-6.59-1.08-1.64-.72-2.92-1.74-3.84-3.05-.92-1.31-1.52-2.93-1.82-4.87-.29-1.93-.44-4.08-.44-6.44v-25.29h-10.04v-6.49h10.04v-13.09h7.67v13.09h13.58v6.49z"/><path class="cls-5" d="M777.85 321.94c-2.75 3.54-5.77 6.02-9.05 7.43s-7.08 2.12-11.41 2.12c-3.61.0-6.85-.64-9.74-1.92-2.89-1.28-5.33-3-7.33-5.17s-3.54-4.72-4.62-7.67-1.62-6.1-1.62-9.45c0-3.54.59-6.8 1.77-9.79 1.18-2.98 2.82-5.54 4.92-7.67 2.1-2.13 4.59-3.79 7.48-4.97s6.03-1.77 9.45-1.77c3.21.0 6.17.54 8.86 1.62s5 2.66 6.94 4.72c1.93 2.07 3.43 4.59 4.48 7.58 1.05 2.99 1.57 6.38 1.57 10.18v2.46h-37.19c.13 1.97.61 3.85 1.43 5.66.82 1.81 1.88 3.38 3.2 4.72 1.31 1.35 2.85 2.41 4.62 3.2 1.77.79 3.71 1.18 5.8 1.18 3.35.0 6.17-.59 8.46-1.77 2.29-1.18 4.36-2.92 6.2-5.21l5.8 4.53zM771.26 303.14c-.13-3.94-1.41-7.08-3.84-9.45-2.43-2.36-5.77-3.54-10.04-3.54s-7.71 1.18-10.33 3.54-4.2 5.51-4.72 9.45h28.93z"/><path class="cls-5" d="M840.82 330.3h-7.58l-13.09-35.42h-.2l-11.61 35.42h-7.87l-14.96-46.05h8.46l10.53 35.42h.2l11.91-35.42h8.07l12.1 35.42h.2l10.43-35.42h8.26l-14.86 46.05z"/><path class="cls-5" d="M863.74 290.16c2.36-2.43 5.17-4.21 8.41-5.36 3.25-1.15 6.54-1.72 9.89-1.72 6.82.0 11.74 1.61 14.76 4.82s4.53 8.1 4.53 14.66v19.78c0 1.31.06 2.67.2 4.08.13 1.41.29 2.71.49 3.89h-7.38c-.26-1.05-.41-2.21-.44-3.49-.04-1.28-.05-2.41-.05-3.39h-.2c-1.51 2.36-3.53 4.3-6.05 5.81-2.53 1.51-5.56 2.26-9.1 2.26-2.36.0-4.58-.29-6.64-.89-2.07-.59-3.87-1.46-5.41-2.61-1.54-1.15-2.77-2.57-3.69-4.28-.92-1.71-1.38-3.67-1.38-5.9.0-3.8.98-6.79 2.95-8.95 1.97-2.16 4.41-3.77 7.33-4.82 2.92-1.05 6.07-1.7 9.45-1.97 3.38-.26 6.48-.39 9.3-.39h2.95v-1.38c0-3.35-1-5.87-3-7.58s-4.8-2.56-8.41-2.56c-2.49.0-4.94.41-7.33 1.23-2.4.82-4.51 2.08-6.35 3.79l-4.82-5.02zm22.24 18c-4.92.0-8.82.69-11.71 2.07s-4.33 3.64-4.33 6.79c0 2.89.97 4.94 2.9 6.15s4.34 1.82 7.23 1.82c2.23.0 4.18-.38 5.85-1.13 1.67-.75 3.07-1.75 4.18-3 1.12-1.25 1.97-2.71 2.56-4.38.59-1.67.92-3.46.98-5.36v-2.95h-7.68z"/><path class="cls-5" d="M932.32 340.83c-.79 1.97-1.59 3.75-2.41 5.36-.82 1.61-1.8 2.98-2.95 4.13-1.15 1.15-2.53 2.03-4.13 2.66-1.61.62-3.56.93-5.85.93-1.12.0-2.28-.07-3.49-.2s-2.35-.46-3.39-.98l.98-6.69c.79.33 1.61.54 2.46.64.85.1 1.84.15 2.95.15 2.49.0 4.33-.69 5.51-2.07s2.2-3.21 3.05-5.51l3.15-8.66-19.09-46.34h8.95l14.27 36.11h.2l13.68-36.11h8.36l-22.24 56.57z"/></g></g></g></svg></span><span class=navbar-brand__name>Envoy Gateway</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/eg-pr-preview/6-test-preview/docs><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/6-test-preview/news><span>News</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/6-test-preview/about><span>About</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/6-test-preview/contributions><span>Contributions</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//latest>latest</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//docs>v1.2</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v1.1>v1.1</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v1.0>v1.0</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v0.6>v0.6</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v0.5>v0.5</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v0.4>v0.4</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v0.3>v0.3</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/6-test-preview//v0.2>v0.2</a></li></ul></div></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/eg-pr-preview/6-test-preview/zh/>中文</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/eg-pr-preview/6-test-preview/offline-search-index.2cce2587fabc03ed99234d30898cf310.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/eg-pr-preview/6-test-preview/offline-search-index.2cce2587fabc03ed99234d30898cf310.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/eg-pr-preview/6-test-preview/zh/>中文</a></li></ul></div></div><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-eg-pr-preview6-test-previewv10-li><a href=/eg-pr-preview/6-test-preview/v1.0/ title="Welcome to Envoy Gateway" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-eg-pr-preview6-test-previewv10><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-eg-pr-preview6-test-previewv10tasks-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasks-check checked>
<label for=m-eg-pr-preview6-test-previewv10tasks-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10tasks><span>Tasks</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksquickstart-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksquickstart-check>
<label for=m-eg-pr-preview6-test-previewv10tasksquickstart-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksquickstart><span>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10taskstraffic-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffic-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffic-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10taskstraffic><span>Traffic</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficcircuit-breaker-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficcircuit-breaker-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficcircuit-breaker-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/circuit-breaker/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficcircuit-breaker><span>Circuit Breakers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficclient-traffic-policy-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficclient-traffic-policy-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficclient-traffic-policy-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/client-traffic-policy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficclient-traffic-policy><span>Client Traffic Policy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficfault-injection-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficfault-injection-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficfault-injection-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/fault-injection/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficfault-injection><span>Fault Injection</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficgateway-address-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficgateway-address-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficgateway-address-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/gateway-address/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficgateway-address><span>Gateway Address</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficgatewayapi-support-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficgatewayapi-support-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficgatewayapi-support-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/gatewayapi-support/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficgatewayapi-support><span>Gateway API Support</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficglobal-rate-limit-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficglobal-rate-limit-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficglobal-rate-limit-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/global-rate-limit/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficglobal-rate-limit><span>Global Rate Limit</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficgrpc-routing-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficgrpc-routing-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficgrpc-routing-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/grpc-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficgrpc-routing><span>GRPC Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-redirect-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-redirect-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-redirect-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-redirect/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-redirect><span>HTTP Redirects</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-headers-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-headers-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-headers-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-request-headers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-headers><span>HTTP Request Headers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-response-headers-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-response-headers-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-response-headers-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-response-headers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-response-headers><span>HTTP Response Headers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-routing-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-routing-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-routing-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-routing><span>HTTP Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-timeouts-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-timeouts-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-timeouts-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-timeouts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-timeouts><span>HTTP Timeouts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-urlrewrite-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-urlrewrite-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-urlrewrite-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-urlrewrite/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-urlrewrite><span>HTTP URL Rewrite</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp3-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp3-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp3-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http3/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp3><span>HTTP3</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-mirroring-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-mirroring-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-mirroring-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-request-mirroring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-request-mirroring><span>HTTPRoute Request Mirroring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-traffic-splitting-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffichttp-traffic-splitting-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffichttp-traffic-splitting-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/http-traffic-splitting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffichttp-traffic-splitting><span>HTTPRoute Traffic Splitting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficlocal-rate-limit-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficlocal-rate-limit-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficlocal-rate-limit-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/local-rate-limit/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficlocal-rate-limit><span>Local Rate Limit</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficmulticluster-service-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficmulticluster-service-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficmulticluster-service-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/multicluster-service/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficmulticluster-service><span>Multicluster Service Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficretry-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficretry-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficretry-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/retry/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficretry><span>Retry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficrouting-outside-kubernetes-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficrouting-outside-kubernetes-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficrouting-outside-kubernetes-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/routing-outside-kubernetes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficrouting-outside-kubernetes><span>Routing outside Kubernetes</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstraffictcp-routing-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstraffictcp-routing-check>
<label for=m-eg-pr-preview6-test-previewv10taskstraffictcp-routing-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/tcp-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstraffictcp-routing><span>TCP Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskstrafficudp-routing-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskstrafficudp-routing-check>
<label for=m-eg-pr-preview6-test-previewv10taskstrafficudp-routing-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/udp-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskstrafficudp-routing><span>UDP Routing</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-eg-pr-preview6-test-previewv10taskssecurity-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecurity-check checked>
<label for=m-eg-pr-preview6-test-previewv10taskssecurity-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10taskssecurity><span>Security</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritybackend-tls-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritybackend-tls-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritybackend-tls-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/backend-tls/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritybackend-tls><span>Backend TLS: Gateway to Backend</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritybasic-auth-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritybasic-auth-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritybasic-auth-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/basic-auth/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritybasic-auth><span>Basic Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritycors-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritycors-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritycors-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/cors/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritycors><span>CORS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecurityext-auth-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecurityext-auth-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecurityext-auth-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/ext-auth/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecurityext-auth><span>External Authorization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecurityjwt-authentication-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecurityjwt-authentication-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecurityjwt-authentication-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/jwt-authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecurityjwt-authentication><span>JWT Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritymutual-tls-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritymutual-tls-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritymutual-tls-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/mutual-tls/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritymutual-tls><span>Mutual TLS: External Clients to the Gateway</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecurityoidc-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecurityoidc-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecurityoidc-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/oidc/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecurityoidc><span>OIDC Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritysecure-gateways-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritysecure-gateways-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritysecure-gateways-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/secure-gateways/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritysecure-gateways><span>Secure Gateways</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-eg-pr-preview6-test-previewv10taskssecuritythreat-model-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritythreat-model-check checked>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritythreat-model-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/threat-model/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritythreat-model><span class=td-sidebar-nav-active-item>Threat Model</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-passthrough-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritytls-passthrough-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritytls-passthrough-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/tls-passthrough/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-passthrough><span>TLS Passthrough</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-termination-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritytls-termination-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritytls-termination-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/tls-termination/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-termination><span>TLS Termination for TCP</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-cert-manager-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10taskssecuritytls-cert-manager-check>
<label for=m-eg-pr-preview6-test-previewv10taskssecuritytls-cert-manager-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/tls-cert-manager/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10taskssecuritytls-cert-manager><span>Using cert-manager For TLS Termination</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10tasksextensibility-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksextensibility-check>
<label for=m-eg-pr-preview6-test-previewv10tasksextensibility-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/extensibility/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10tasksextensibility><span>Extensibility</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksextensibilityenvoy-patch-policy-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksextensibilityenvoy-patch-policy-check>
<label for=m-eg-pr-preview6-test-previewv10tasksextensibilityenvoy-patch-policy-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/extensibility/envoy-patch-policy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksextensibilityenvoy-patch-policy><span>Envoy Patch Policy</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10tasksobservability-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksobservability-check>
<label for=m-eg-pr-preview6-test-previewv10tasksobservability-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/observability/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10tasksobservability><span>Observability</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksobservabilitygateway-api-metrics-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksobservabilitygateway-api-metrics-check>
<label for=m-eg-pr-preview6-test-previewv10tasksobservabilitygateway-api-metrics-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/observability/gateway-api-metrics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksobservabilitygateway-api-metrics><span>Gateway API Metrics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksobservabilityproxy-observability-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksobservabilityproxy-observability-check>
<label for=m-eg-pr-preview6-test-previewv10tasksobservabilityproxy-observability-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/observability/proxy-observability/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksobservabilityproxy-observability><span>Proxy Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksobservabilitygrafana-integration-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksobservabilitygrafana-integration-check>
<label for=m-eg-pr-preview6-test-previewv10tasksobservabilitygrafana-integration-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/observability/grafana-integration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksobservabilitygrafana-integration><span>Visualising metrics using Grafana</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10tasksoperations-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksoperations-check>
<label for=m-eg-pr-preview6-test-previewv10tasksoperations-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10tasksoperations><span>Operations</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksoperationscustomize-envoyproxy-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksoperationscustomize-envoyproxy-check>
<label for=m-eg-pr-preview6-test-previewv10tasksoperationscustomize-envoyproxy-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/customize-envoyproxy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksoperationscustomize-envoyproxy><span>Customize EnvoyProxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksoperationsdeployment-mode-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksoperationsdeployment-mode-check>
<label for=m-eg-pr-preview6-test-previewv10tasksoperationsdeployment-mode-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/deployment-mode/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksoperationsdeployment-mode><span>Deployment Mode</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10tasksoperationsegctl-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10tasksoperationsegctl-check>
<label for=m-eg-pr-preview6-test-previewv10tasksoperationsegctl-check><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/egctl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10tasksoperationsegctl><span>Use egctl</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10install-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10install-check>
<label for=m-eg-pr-preview6-test-previewv10install-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10install><span>Installation</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10installinstall-helm-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10installinstall-helm-check>
<label for=m-eg-pr-preview6-test-previewv10installinstall-helm-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/install-helm/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10installinstall-helm><span>Install with Helm</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10installinstall-yaml-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10installinstall-yaml-check>
<label for=m-eg-pr-preview6-test-previewv10installinstall-yaml-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/install-yaml/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10installinstall-yaml><span>Install with Kubernetes YAML</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10installinstall-egctl-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10installinstall-egctl-check>
<label for=m-eg-pr-preview6-test-previewv10installinstall-egctl-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/install-egctl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10installinstall-egctl><span>Install egctl</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10installcustom-cert-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10installcustom-cert-check>
<label for=m-eg-pr-preview6-test-previewv10installcustom-cert-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/custom-cert/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10installcustom-cert><span>Control Plane Authentication using custom certs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10installapi-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10installapi-check>
<label for=m-eg-pr-preview6-test-previewv10installapi-check><a href=/eg-pr-preview/6-test-preview/v1.0/install/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10installapi><span>gateway-helm</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview6-test-previewv10api-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10api-check>
<label for=m-eg-pr-preview6-test-previewv10api-check><a href=/eg-pr-preview/6-test-preview/v1.0/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview6-test-previewv10api><span>API</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview6-test-previewv10apiextension_types-li><input type=checkbox id=m-eg-pr-preview6-test-previewv10apiextension_types-check>
<label for=m-eg-pr-preview6-test-previewv10apiextension_types-check><a href=/eg-pr-preview/6-test-preview/v1.0/api/extension_types/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview6-test-previewv10apiextension_types><span>API Reference</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/envoyproxy/gateway/tree/main/site/content/en/v1.0/tasks/security/threat-model.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/envoyproxy/gateway/edit/main/site/content/en/v1.0/tasks/security/threat-model.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/envoyproxy/gateway/new/main/site/content/en/v1.0/tasks/security?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/envoyproxy/gateway/issues/new?title=Threat%20Model" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/envoyproxy/gateway/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#about>About</a></li><li><a href=#threat-modelling-team>Threat Modelling Team</a></li><li><a href=#reviewers>Reviewers</a></li><li><a href=#introduction>Introduction</a><ul><li><a href=#scope>Scope</a></li><li><a href=#in-scope>In Scope</a></li><li><a href=#related-resources>Related Resources</a></li></ul></li><li><a href=#architecture-overview>Architecture Overview</a><ul><li><a href=#summary>Summary</a></li><li><a href=#deployment-architecture-diagram>Deployment Architecture Diagram</a></li></ul></li><li><a href=#key-assumptions>Key Assumptions</a></li><li><a href=#data>Data</a><ul><li><a href=#data-dictionary>Data Dictionary</a></li><li><a href=#cia-impact-assessment>CIA Impact Assessment</a></li><li><a href=#data-flow-diagrams>Data Flow Diagrams</a></li><li><a href=#dfd-l0>DFD L0</a></li><li><a href=#dfd-l1>DFD L1</a></li></ul></li><li><a href=#key-threats-and-recommendations>Key Threats and Recommendations</a><ul><li><a href=#risk-vs-threat>Risk vs. Threat</a></li><li><a href=#threat-categorization>Threat Categorization</a></li><li><a href=#threat-actors>Threat Actors</a></li></ul></li><li><a href=#high-priority-findings>High Priority Findings</a><ul><li><a href=#egtm-001-usage-of-self-signed-certificates>EGTM-001 Usage of self-signed certificates</a></li><li><a href=#egtm-002-private-keys-are-stored-as-kubernetes-secrets>EGTM-002 Private keys are stored as Kubernetes secrets</a></li><li><a href=#egtm-004-usage-of-clusterroles-with-wide-permissions>EGTM-004 Usage of ClusterRoles with wide permissions</a></li><li><a href=#egtm-007-misconfiguration-of-envoy-gateway-dynamic-config>EGTM-007 Misconfiguration of Envoy Gateway dynamic config</a></li><li><a href=#egtm-009-co-tenant-misconfigures-resource-across-namespaces>EGTM-009 Co-tenant misconfigures resource across namespaces</a></li><li><a href=#egtm-014-malicious-image-admission>EGTM-014 Malicious image admission</a></li><li><a href=#egtm-020-out-of-date-or-misconfigured-envoy-proxy-image>EGTM-020 Out of date or misconfigured Envoy Proxy image</a></li><li><a href=#egtm-022-credentials-are-stored-as-kubernetes-secrets>EGTM-022 Credentials are stored as Kubernetes Secrets</a></li><li><a href=#egtm-023-weak-authentication>EGTM-023 Weak Authentication</a></li></ul></li><li><a href=#medium-priority-findings>Medium Priority Findings</a><ul><li><a href=#egtm-008-misconfiguration-of-envoy-gateway-static-config>EGTM-008 Misconfiguration of Envoy Gateway static config</a></li><li><a href=#egtm-010-weak-pod-security-contexts-and-policies>EGTM-010 Weak pod security contexts and policies</a></li><li><a href=#egtm-012-clusterroles-and-roles-with-permission-to-deploy-referencegrants>EGTM-012 ClusterRoles and Roles with permission to deploy ReferenceGrants</a></li><li><a href=#egtm-018-network-denial-of-service-dos>EGTM-018 Network Denial of Service (DoS)</a></li><li><a href=#egtm-019-jwt-based-authentication-replay-attacks>EGTM-019 JWT-based authentication replay attacks</a></li><li><a href=#egtm-024-excessive-privileges-via-extension-policies>EGTM-024 Excessive privileges via extension policies</a></li></ul></li><li><a href=#low-priority-findings>Low Priority Findings</a><ul><li><a href=#egtm-003-misconfiguration-leads-to-insecure-tls-settings>EGTM-003 Misconfiguration leads to insecure TLS settings</a></li><li><a href=#egtm-005-envoy-gateway-helm-chart-deployment-does-not-set-apparmor-and-seccomp-profiles>EGTM-005 Envoy Gateway Helm chart deployment does not set AppArmor and Seccomp profiles</a></li><li><a href=#egtm-006-envoy-proxy-pods-deployed-with-a-shell-enabled>EGTM-006 Envoy Proxy pods deployed with a shell enabled</a></li><li><a href=#egtm-011-route-bindings-on-custom-labels>EGTM-011 Route Bindings on custom labels</a></li><li><a href=#egtm-013-gatewayclass-namespace-validation-is-not-configured>EGTM-013 GatewayClass namespace validation is not configured</a></li><li><a href=#egtm-015-serviceaccount-token-authentication>EGTM-015 ServiceAccount token authentication</a></li><li><a href=#egtm-016-misconfiguration-leads-to-lack-of-envoy-proxy-access-activity-visibility>EGTM-016 Misconfiguration leads to lack of Envoy Proxy access activity visibility</a></li><li><a href=#egtm-017-misconfiguration-leads-to-lack-of-envoy-gateway-activity-visibility>EGTM-017 Misconfiguration leads to lack of Envoy Gateway activity visibility</a></li><li><a href=#egtm-021-exposed-envoy-proxy-admin-interface>EGTM-021 Exposed Envoy Proxy admin interface</a></li><li><a href=#egtm-025-envoy-proxy-pods-deployed-running-as-root-user-in-the-container>EGTM-025 Envoy Proxy pods deployed running as root user in the container</a></li></ul></li><li><a href=#appendix>Appendix</a><ul><li><a href=#in-scope-threat-actor-details>In Scope Threat Actor Details</a></li><li><a href=#identified-threats-by-priority>Identified Threats by Priority</a></li></ul></li><li><a href=#attack-trees>Attack Trees</a><ul><li><a href=#node-id-schema>Node ID Schema</a></li><li><a href=#logical-operators>Logical Operators</a></li><li><a href=#attack-tree-node-legend>Attack Tree Node Legend</a></li><li><a href=#at0>AT0</a></li><li><a href=#at1>AT1</a></li><li><a href=#at2>AT2</a></li><li><a href=#at3>AT3</a></li><li><a href=#at4>AT4</a></li><li><a href=#at5>AT5</a></li><li><a href=#at6>AT6</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/eg-pr-preview/6-test-preview/v1.0/>Documentation</a></li><li class=breadcrumb-item><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/>Tasks</a></li><li class=breadcrumb-item><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/>Security</a></li><li class="breadcrumb-item active" aria-current=page>Threat Model</li></ol></nav><div class=td-content><h1>Threat Model</h1><header class=article-meta><p class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>&nbsp; 52 minute read &nbsp;</p></header><h1 id=envoy-gateway-threat-model-and-end-user-recommendations>Envoy Gateway Threat Model and End User Recommendations<a class=td-heading-self-link href=#envoy-gateway-threat-model-and-end-user-recommendations aria-label="Heading self-link"></a></h1><h2 id=about>About<a class=td-heading-self-link href=#about aria-label="Heading self-link"></a></h2><p>This work was performed by <a href=https://control-plane.io/>ControlPlane</a> and commissioned by the <a href=https://www.linuxfoundation.org/>Linux Foundation</a>. ControlPlane is a global cloud native and open source cybersecurity consultancy, trusted as the partner of choice in securing: multinational banks; major public clouds; international financial institutions; critical national infrastructure programs; multinational oil and gas companies, healthcare and insurance providers; and global media firms.</p><h2 id=threat-modelling-team>Threat Modelling Team<a class=td-heading-self-link href=#threat-modelling-team aria-label="Heading self-link"></a></h2><p>James Callaghan, Torin van den Bulk, Eduardo Olarte</p><h2 id=reviewers>Reviewers<a class=td-heading-self-link href=#reviewers aria-label="Heading self-link"></a></h2><p>Arko Dasgupta, Matt Turner, Zack Butcher, Marco De Benedictis</p><h2 id=introduction>Introduction<a class=td-heading-self-link href=#introduction aria-label="Heading self-link"></a></h2><p>As we embrace the proliferation of microservice-based architectures in the cloud-native landscape, simplicity in setup and configuration becomes paramount as DevOps teams face the challenge of choosing between numerous similar technologies. One such choice which every team deploying to Kubernetes faces is what to use as an ingress controller. With a plethora of options available, and the existence of vendor-specific annotations leading to small inconsistencies between implementations, the <a href=https://gateway-api.sigs.k8s.io/>Gateway API</a> project was introduced by the SIG-NETWORK community, with the goal of eventually replacing the Ingress resource.</p><p>Envoy Gateway is configured by Gateway API resources, and serves as an intuitive and feature-rich wrapper over the widely acclaimed Envoy Proxy. With a convenient setup based on Kubernetes (K8s) manifests, Envoy Gateway streamlines the management of Envoy Proxy instances in an edge-proxy setting, reducing the operational overhead of managing low-level Envoy configurations. Envoy Gateway benefits cloud-native DevOps teams through its role-oriented configuration, providing granular control based on Role-Based Access Control (RBAC) principles. These features form the basis of our exploration into Envoy Gateway and the rich feature set it brings to the table.</p><p>In this threat model, we aim to provide an analysis of Envoy Gateway&rsquo;s design components and their capabilities (at version 1.0) through a threat-driven approach. It should be noted that this does not constitute a security audit of the Envoy Gateway project, but instead focuses on different possible deployment topologies for Envoy Gateway with the goal of deriving recommendations and best practice guidance for end users.</p><p>The Envoy Gateway project recommends a <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/deployment-mode/#multi-tenancy>multi-tenancy model</a> whereby each tenant deploys their own Envoy Gateway controller in a namespace which they own. We will also explore the implications and risks associated with multiple tenants using a shared controller.</p><h3 id=scope>Scope<a class=td-heading-self-link href=#scope aria-label="Heading self-link"></a></h3><p>The primary focus of this threat model is to identify and assess security risks associated with deploying and operating Envoy Gateway within a multi-tenant Kubernetes (K8s) cluster. This model aims to provide a comprehensive understanding of the system, its transmission points, and potential vulnerabilities to enumerated threats.</p><h3 id=in-scope>In Scope<a class=td-heading-self-link href=#in-scope aria-label="Heading self-link"></a></h3><p><strong>Envoy Gateway</strong>: As the primary focus of this threat model, all aspects of Envoy Gateway, including its configuration, deployment, and operation will be analysed. This includes how the gateway manages TLS certificates, authentication, service-to-service traffic routing, and more.</p><p><strong>Kubernetes Cluster</strong>: Configuration and operation of the underlying Kubernetes cluster, including how it manages network policies, access control, and resource isolation for different namespaces/tenants in relation to Envoy will be considered.</p><p><strong>Tenant Workloads</strong>: Tenant workloads (and the pods they run on) will be considered, focusing on how they interact with the Envoy Gateway and potential vulnerabilities that could be exploited.</p><h4 id=out-of-scope>Out of Scope<a class=td-heading-self-link href=#out-of-scope aria-label="Heading self-link"></a></h4><p>This threat model will not consider security risks associated with the underlying infrastructure (e.g., EC2 compute instances and S3 buckets) or non-Envoy related components within the Kubernetes Cluster. It will focus solely on the Envoy Gateway and its interaction with the Kubernetes cluster and tenant workloads.</p><p>Implementation of Envoy Gateway as an egress traffic controller is out of scope for this threat model and will not be considered in the report&rsquo;s findings.</p><h3 id=related-resources>Related Resources<a class=td-heading-self-link href=#related-resources aria-label="Heading self-link"></a></h3><p><a href=https://blog.envoyproxy.io/introducing-envoy-gateway-ad385cc59532>Introducing Envoy Gateway</a></p><p><a href=https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/security/threat_model#threat-model>Envoy Proxy Threat Model</a></p><p><a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge#best-practices-edge>Configuring Envoy as an Edge Proxy</a></p><p><a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/deployment-mode/>Envoy Gateway Deployment Mode</a></p><p><a href=https://gateway-api.sigs.k8s.io/concepts/security-model/>Kubernetes Gateway API Security Model</a></p><h2 id=architecture-overview>Architecture Overview<a class=td-heading-self-link href=#architecture-overview aria-label="Heading self-link"></a></h2><h3 id=summary>Summary<a class=td-heading-self-link href=#summary aria-label="Heading self-link"></a></h3><p>To provide an in-depth look into both the system design and end-user deployment of Envoy Gateway, we will be focusing on the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/threat-model/#deployment-architecture-diagram>Deployment Architecture Diagram</a> below.</p><p>The Deployment Architecture Diagram provides a high-level model of an end-user deployment of Envoy Gateway. For simplicity, we will look at different deployment topologies on a single multi-tenant Kubernetes cluster. Envoy Gateway operates as an edge proxy within this environment, handling the traffic flow between external interfaces and services within the cluster. The example will use two Envoy Gateway controllers - one dedicated controller for a single tenant, and one shared controller for two other tenants. Each Envoy Gateway controller will accept a single GatewayClass resource.</p><h3 id=deployment-architecture-diagram>Deployment Architecture Diagram<a class=td-heading-self-link href=#deployment-architecture-diagram aria-label="Heading self-link"></a></h3><p>As Envoy Gateway implements the <a href=https://gateway-api.sigs.k8s.io/concepts/api-overview/>Kubernetes GatewayAPI</a>, this threat model will focus on the key objects in the Gateway API resource model:</p><ol><li><p><strong>GatewayClass:</strong> defines a set of gateways with a commonconfiguration and behaviour. It is a cluster scoped resource.</p></li><li><p><strong>Gateway:</strong> requests a point where traffic can be translated to Services within the cluster.</p></li><li><p><strong>Routes:</strong> describe how traffic coming via the Gateway maps to theServices.</p></li></ol><p>At the time of writing, Envoy Gateway only supports a Kubernetes provider. As such, we will consider a reference architecture where multiple teams are working on the same Kubernetes cluster within different namespaces (Tenant A, B, & C). We will assume that some teams have similar security and performance needs, and a decision has been made to use a shared Gateway. However, we will also consider the case that some teams require dedicated Gateways, perhaps for compliance reasons or requirements driven by an internal threat model.</p><p>We will consider the following organisational roles, as per the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/>Gateway API security model</a>:</p><ol><li><p><strong>Infrastructure provider</strong>: The infrastructure provider (infra) is responsible for the overall environment that the cluster(s) are operating in. Examples include: the cloud provider (AWS, Azure, GCP, &mldr;) or the PaaS provider in a company.</p></li><li><p><strong>Cluster operator</strong>: The cluster operator (ops) is responsible for administration of entire clusters. They manage policies, network access, application permissions.</p></li><li><p><strong>Application developer</strong>: The application developer (dev) is responsible for defining their application configuration (e.g. timeouts, request matching/filter) and Service composition (e.g. path routing to backends).</p></li><li><p><strong>Application admin</strong>: The application admin has administrative access to some namespaces within a cluster, but not the cluster as a whole.</p></li></ol><p>Our threat model will be based on the high-level setup shown below, where Envoy is used in an edge-proxy scenario:</p><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/architecture_threat_model.png alt=Architecture></p><p>The following use cases will be considered, in line with the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/quickstart/>Envoy Gateway Tasks</a>:</p><ol><li>Routing and controlling traffic, including:
a. HTTP<br>b. TCP<br>c. UDP<br>d. gRPC<br>e.TLS passthrough</li><li>TLS termination</li><li>Request Authentication</li><li>Rate Limiting</li></ol><h2 id=key-assumptions>Key Assumptions<a class=td-heading-self-link href=#key-assumptions aria-label="Heading self-link"></a></h2><p>This section outlines the foundational premises that shape our analysis and recommendations for the deployment and management of Envoy Gateway within an organisation. The key assumptions are as follows:</p><p><strong>1. Kubernetes Provider</strong>: For the purposes of this analysis, we assume that a K8s provider will be used to host the cluster.</p><p><strong>2. Multi-tenant cluster</strong>: In order to produce a broad set of recommendations, it is assumed that within the single cluster, there is:</p><ul><li><p>A dedicated cluster operation (ops) team responsible for maintaining the core cluster infrastructure.</p></li><li><p>Multiple application teams who wish to define their own Gateway resources, which will route traffic to their respective applications.</p></li></ul><p><strong>3. Soft multi-tenancy model</strong>: It is assumed that co-tenants will have some level of trust between themselves, and will not act in an overtly hostile manner to each other.</p><p><strong>4. Ingress Control</strong>: It&rsquo;s assumed that Envoy Gateway is the only ingress controller in the K8s cluster as multiple controllers can lead to complex routing challenges and introduce out-of-scope security vulnerabilities.</p><p><strong>5. Container Security</strong>: This threat model focuses on evaluating the security of the Envoy Gateway and Envoy Proxy images. All other container images running in tenant clusters, not associated with the edge proxy deployment, are assumed to be secure and obtained from trusted registries such as Docker Hub or Google Container Registry (GCR).</p><p><strong>6. Cloud Provider Security</strong>: It is assumed that the K8s cluster is running on secure cloud infrastructure provided by a trusted Cloud Service Provider (CSP) such as AWS, GCP, or Azure Cloud.</p><h2 id=data>Data<a class=td-heading-self-link href=#data aria-label="Heading self-link"></a></h2><h3 id=data-dictionary>Data Dictionary<a class=td-heading-self-link href=#data-dictionary aria-label="Heading self-link"></a></h3><p>Ultimately, the data of interest in a threat model is the business data processed by the system in question. However, in the case of this threat model, we are looking at a generic deployment architecture involving Envoy Gateway in order to draw out a set of generalised threats which can be considered by teams looking to adopt an implementation of Gateway API. As such, we do not know the business impacts of a compromise of confidentiality, integrity or availability that would typically be captured in a data impact assessment. Instead, will we base our threat assessment on high-level groupings of data structures used in the configuration and operation of the general use cases considered (e.g. HTTP routing, TLS termination, request authentication etc.). We will then assign a confidentiality, integrity and availability impact based on a worst-case scenario of how each compromise could potentially affect business data processed by the generic deployment.</p><table><thead><tr><th>Data Name / Type</th><th>Notes</th><th>Confidentiality</th><th>Integrity</th><th>Availability</th></tr></thead><tbody><tr><td>Static Configuration Data</td><td>Static configuration data is used to configure Envoy Gateway at startup. This data structure allows for a Provider to be set, which Envoy Gateway calls to establish its runtime configuration, resolve services and persist data. Unauthorised modification of static configuration data could enable the Envoy Gateway admin interface to be configured, logging parameters to be modified, global rate limiting configuration to be misconfigured, or malicious extensions registered for the Envoy Gateway Control Plane. A compromise of confidentiality could potentially give an attacker some useful reconnaissance information. A compromise of the availability of this information at startup time would result in Envoy Gateway starting with default parameters.</td><td>Medium</td><td>High</td><td>Low</td></tr><tr><td>Dynamic Configuration Data</td><td>Dynamic configuration data represents the desired state of the Data Plane, and is defined through Envoy Gateway and Gateway API Kubernetes resources. Unauthorised modification of this data could lead to vulnerabilities in an organisation’s Data Plane infrastructure via misconfiguration of an EnvoyProxy custom resource. Misconfiguration of Gateway API objects such as HTTPRoutes or TLSRoutes could result in traffic being directed to incorrect backends. A compromise of confidentiality could potentially give an attacker some useful reconnaissance information. A compromise of the availability of this information could result in tenant application traffic not being routable until the configuration is recovered and reapplied.</td><td>Medium</td><td>High</td><td>Medium</td></tr><tr><td>TLS Private Keys</td><td>TLS Private Keys, typically in PEM format, are used to initiate secure connections and encrypt communications. In the context of this threat model, private keys will be associated with the server side of an inbound TLS connection being terminated at a secure gateway configured through Envoy Gateway. Unauthorised exposure could lead to security threats such as person-in-the-middle attacks, whereby the confidentiality or integrity of business data could be compromised. A compromise of integrity may lead to similar consequences if an attacker could insert their own key material. An availability compromise could lead to tenant services being unavailable until new key material is generated and an appropriate CSR submitted.</td><td>High</td><td>High</td><td>Medium</td></tr><tr><td>TLS Certificates</td><td>X.509 certificates represent the binding of a public key (associated with the private key described above) to an identity in a TLS handshake. If an attacker could compromise the integrity of a certificate, they may be able to bind the identity of a TLS termination point to a key pair under their control, enabling person-in-the middle attacks. An availability compromise could lead to tenant services being unavailable until new key material is generated and an appropriate CSR submitted.</td><td>Low</td><td>High</td><td>Medium</td></tr><tr><td>JWKs</td><td>JWK (JSON Web Key) containing a public key used to validate JWTs for the client authentication use case considered in this threat model. If an attacker could compromise the integrity of a JWK or JSON web key set (JWKS), they could potentially authenticate to a service maliciously. Unavailability of an endpoint exposing JWKs could lead to client requests which require authentication being denied.</td><td>Low</td><td>High</td><td>Medium</td></tr><tr><td>JWTs</td><td>JWTs, formatted as compact, URL-safe JSON data structures, are utilised for the client authentication use case considered in this threat model. Maintaining their confidentiality and integrity is vital to prevent unauthorised access and ensure correct user identification.</td><td>High</td><td>High</td><td>Low</td></tr><tr><td>OIDC credentials</td><td>In OIDC authentication scenarios, the application credentials are represented by a client ID and a client secret. A compromise of its confidentiality or integrity could allow malicious actors to impersonate the application, potentially being able to access resources on behalf of the application and request ID tokens on behalf of users. Unavailability of this data would produce a rejection of the requests coming from legitimate users.</td><td>High</td><td>High</td><td>Medium</td></tr><tr><td>Basic authentiation password hashes</td><td>In basic authentication scenarios, passwords are stored as Kubernetes secrets in <a href=https://httpd.apache.org/docs/current/programs/htpasswd.html>htpasswd</a> format, where each entry is formed by the username and the hashed password. A compromise of these credentials&rsquo; confidentiality and integrity could lead to unauthorised access to the application. Unavailability of these credentials will cause login failures from the application users.</td><td>High</td><td>High</td><td>Medium</td></tr></tbody></table><h3 id=cia-impact-assessment>CIA Impact Assessment<a class=td-heading-self-link href=#cia-impact-assessment aria-label="Heading self-link"></a></h3><table><thead><tr><th>Priority</th><th>Description</th></tr></thead><tbody><tr><td><strong>Confidentiality</strong></td><td></td></tr><tr><td>High</td><td>Compromise of sensitive client data</td></tr><tr><td>Medium</td><td>Information leaked which could be useful for attacker reconnaissance</td></tr><tr><td>Low</td><td>Non-sensitive information leakage</td></tr><tr><td><strong>Integrity</strong></td><td></td></tr><tr><td>High</td><td>Compromise of source code repositories and gateway deployments</td></tr><tr><td>Medium</td><td>Traffic routing fails due to misconfiguration / invalid configuration</td></tr><tr><td>Low</td><td>Non-critical operation is blocked due to misconfiguration / invalid configuration</td></tr><tr><td><strong>Availability</strong></td><td></td></tr><tr><td>High</td><td>Large scale DoS</td></tr><tr><td>Medium</td><td>Tenant application is blocked for a significant period</td></tr><tr><td>Low</td><td>Tenant application is blocked for a short period</td></tr></tbody></table><h3 id=data-flow-diagrams>Data Flow Diagrams<a class=td-heading-self-link href=#data-flow-diagrams aria-label="Heading self-link"></a></h3><p>The Data Flow Diagrams (DFDs) below describe the flow of data between the various processes, entities and data stores in a system, as well as the trust boundaries between different user roles and network interfaces. The DFDs are drawn at two different levels, starting at L0 (high-level system view) and increasing in granularity (to L1).</p><h3 id=dfd-l0>DFD L0<a class=td-heading-self-link href=#dfd-l0 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/DFDL0.png alt="DFD L0"></p><h3 id=dfd-l1>DFD L1<a class=td-heading-self-link href=#dfd-l1 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/DFDL1.png alt="DFD L1"></p><h2 id=key-threats-and-recommendations>Key Threats and Recommendations<a class=td-heading-self-link href=#key-threats-and-recommendations aria-label="Heading self-link"></a></h2><p>The scope of this threat model led to us categorising threats into priorities of High, Medium or Low; notably in a production implementation some of the threats&rsquo; prioritisation may be upgraded or downgraded depending on the business context and data classification.</p><h3 id=risk-vs-threat>Risk vs. Threat<a class=td-heading-self-link href=#risk-vs-threat aria-label="Heading self-link"></a></h3><p>For every finding, the risk and threat are stated. Risk defines the potential for negative outcome while threat defines the event that causes the negative outcome.</p><h3 id=threat-categorization>Threat Categorization<a class=td-heading-self-link href=#threat-categorization aria-label="Heading self-link"></a></h3><p>Throughout this threat model, we categorised threats into different areas based on their origin and the segment of the system that they impact. Here&rsquo;s an overview of each category:</p><p><strong>Container Security (CS)</strong>: These threats are general to containerised applications. Therefore, they are not associated with Envoy Gateway or the Gateway API and could occur in most containerised workloads. They can originate from misconfigurations or vulnerabilities in the orchestrator or the container.</p><p><strong>Gateway API (GW)</strong>: These are threats related to the Gateway API that could affect any of its implementations. Malicious actors could benefit from misconfigurations or excessive permissions on the Gateway API resources (e.g. xRoutes or Gateways) to compromise the confidentiality, integrity, or availability of the application.</p><p><strong>Envoy Gateway (EG)</strong>: These threats are associated with specific configurations or features from Envoy Gateway or Envoy Proxy. If not set properly, these features could be leveraged to gain unauthorised access to protected resources.</p><h3 id=threat-actors>Threat Actors<a class=td-heading-self-link href=#threat-actors aria-label="Heading self-link"></a></h3><p>In order to provide a realistic set of threats that is applicable to most organisations, we de-scoped the most advanced and hard to mitigate threat actors as described below:</p><h4 id=in-scope-threat-actors>In Scope Threat Actors<a class=td-heading-self-link href=#in-scope-threat-actors aria-label="Heading self-link"></a></h4><p>When considering internal threat actors, we chose to follow the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/>security model</a> of the Kubernetes Gateway API.</p><h5 id=internal-attacker>Internal Attacker<a class=td-heading-self-link href=#internal-attacker aria-label="Heading self-link"></a></h5><ul><li><p>Cluster Operator: The cluster operator (ops) is responsible for administration of entire clusters. They manage policies, network access, application permissions.</p></li><li><p>Application Developer: The application developer (dev) is responsible for defining their application configuration (e.g. timeouts, request matching/filter) and Service composition (e.g. path routing to backends).</p></li><li><p>Application Administrator: The application admin has administrative access to some namespaces within a cluster, but not the cluster as a whole.</p></li></ul><h5 id=external-attacker>External Attacker<a class=td-heading-self-link href=#external-attacker aria-label="Heading self-link"></a></h5><ul><li><p>Vandal: Script kiddie, trespasser</p></li><li><p>Motivated Individual: Political activist, thief, terrorist</p></li><li><p>Organised Crime: Syndicates, state-affiliated groups</p></li></ul><h4 id=out-of-scope-threat-actors>Out of Scope Threat Actors<a class=td-heading-self-link href=#out-of-scope-threat-actors aria-label="Heading self-link"></a></h4><h5 id=external-actors>External Actors<a class=td-heading-self-link href=#external-actors aria-label="Heading self-link"></a></h5><ul><li><p>Infrastructure Provider: The infrastructure provider (infra) is responsible for the overall environment that the cluster(s) are operating in. Examples include: the cloud provider, or the PaaS provider in a company.</p></li><li><p>Cloud Service Insider: Employee, external contractor, temporary worker</p></li><li><p>Foreign Intelligence Services (FIS): Nation states</p></li></ul><h2 id=high-priority-findings>High Priority Findings<a class=td-heading-self-link href=#high-priority-findings aria-label="Heading self-link"></a></h2><h3 id=egtm-001-usage-of-self-signed-certificates>EGTM-001 Usage of self-signed certificates<a class=td-heading-self-link href=#egtm-001-usage-of-self-signed-certificates aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-001</td><td>EGTM-GW-001</td><td>Gateway API</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: Self-signed certificates (which do not comply with PKI best practices) could lead to unauthorised access to the private key associated with the certificate used for inbound TLS termination at Envoy Proxy, compromising the confidentiality and integrity of proxied traffic.</p><p><strong>Threat</strong>: Compromise of the private key associated with the certificate used for inbound TLS terminating at Envoy Proxy.</p><p><strong>Recommendation</strong>: The Envoy Gateway quickstart demonstrates how to set up a Secure Gateway using an example where a self-signed root certificate is created using openssl. As stated in the Envoy Gateway documentation, this is not a suitable configuration for Production usage. It is recommended that PKI best practices are followed, whereby certificates are signed by an Intermediary CA which sits underneath an organisational 'offline' Root CA.</p><p>PKI best practices should also apply to the management of client certificates when using mTLS. The Envoy Gateway <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/mutual-tls/>mTLS</a> guide shows how to set up client certificates using self-signed certificates. In the same way as gateway certificates and, as mentioned in the documentation, this configuration should not be used in production environments.</p><h3 id=egtm-002-private-keys-are-stored-as-kubernetes-secrets>EGTM-002 Private keys are stored as Kubernetes secrets<a class=td-heading-self-link href=#egtm-002-private-keys-are-stored-as-kubernetes-secrets aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-002</td><td>EGTM-CS-001</td><td>Container Security</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor could compromise the Kubernetes secret containing the Envoy private key, allowing the attacker to decrypt Envoy Proxy traffic, compromising the confidentiality of proxied traffic.</p><p><strong>Threat</strong>: Kubernetes secret containing the Envoy private key is compromised and used to decrypt proxied traffic.</p><p><strong>Recommendation</strong>: Certificate management best practices mandate short-lived key material where practical, meaning that a mechanism for rotation of private keys and certificates is required, along with a way for certificates to be mounted into Envoy containers. If Kubernetes secrets are used, when a certificate expires, the associated secret must be updated, and Envoy containers must be redeployed. Instead of a manual configuration, it is recommended that <a href=https://github.com/cert-manager/cert-manager>cert-manager</a> is used.</p><h3 id=egtm-004-usage-of-clusterroles-with-wide-permissions>EGTM-004 Usage of ClusterRoles with wide permissions<a class=td-heading-self-link href=#egtm-004-usage-of-clusterroles-with-wide-permissions aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-004</td><td>EGTM-K8-002</td><td>Container Security</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor could abuse misconfigured RBAC to access the Envoy Gateway ClusterRole (envoy-gateway-role) and use it to expose all secrets across the cluster, thus compromising the confidentiality and integrity of tenant data.</p><p><strong>Threat</strong>: Compromised Envoy Gateway or misconfigured ClusterRoleBinding (envoy-gateway-rolebinding) to Envoy Gateway ClusterRole (envoy-gateway-role), provides access to resources and secrets in different namespaces.</p><p><strong>Recommendation</strong>: Users should be aware that Envoy Gateway uses a ClusterRole (envoy-gateway-role) when deployed via the Helm chart, to allow management of Envoy Proxies across different namespaces. This ClusterRole is powerful and includes the ability to read secrets in namespaces which may not be within the purview of Envoy Gateway.</p><p>Kubernetes best-practices involve restriction of ClusterRoleBindings, with the use of RoleBindings where possible to limit access per namespace by specifying the namespace in metadata. Namespace isolation reduces the impact of compromise from cluster-scoped roles. Ideally, fine-grained K8s roles should be created per the principle of least privilege to ensure they have the minimum access necessary for role functions.</p><p>The pull request #<a href=https://github.com/envoyproxy/gateway/pull/1656>1656</a> introduced the use of Roles and RoleBindings in <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#kuberneteswatchmode>namespaced mode</a>. This feature can be leveraged to reduce the amount of permissions required by the Envoy Gateway.</p><h3 id=egtm-007-misconfiguration-of-envoy-gateway-dynamic-config>EGTM-007 Misconfiguration of Envoy Gateway dynamic config<a class=td-heading-self-link href=#egtm-007-misconfiguration-of-envoy-gateway-dynamic-config aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-007</td><td>EGTM-EG-002</td><td>Envoy Gateway</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor could exploit misconfigured Kubernetes RBAC to create or modify Gateway API resources with no business need, potentially leading to the compromise of the confidentiality, integrity, and availability of resources and traffic within the cluster.</p><p><strong>Threat</strong>: Unauthorised creation or misconfiguration of Gateway API resources by a threat actor with cluster-scoped access.</p><p><strong>Recommendation</strong>: Configure the apiGroup and resource fields in RBAC policies to restrict access to <a href=https://gateway-api.sigs.k8s.io/>Gateway</a> and <a href=https://gateway-api.sigs.k8s.io/api-types/gatewayclass/>GatewayClass</a> resources. Enable namespace isolation by using the namespace field, preventing unauthorised access to gateways in other namespaces.</p><h3 id=egtm-009-co-tenant-misconfigures-resource-across-namespaces>EGTM-009 Co-tenant misconfigures resource across namespaces<a class=td-heading-self-link href=#egtm-009-co-tenant-misconfigures-resource-across-namespaces aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-009</td><td>EGTM-GW-002</td><td>Gateway API</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a co-tenant misconfigures Gateway or Route resources, compromising the confidentiality, integrity, and availability of routed traffic through Envoy Gateway.</p><p><strong>Threat</strong>: Malicious or accidental co-tenant misconfiguration of Gateways and Routes associated with other application teams.</p><p><strong>Recommendation</strong>: Dedicated Envoy Gateways should be provided to each tenant within their respective namespace. A one-to-one relationship should be established between GatewayClass and Gateway resources, meaning that each tenant namespace should have their own GatewayClass watched by a unique Envoy Gateway Controller as defined here in the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/deployment-mode/>Deployment Mode</a> documentation.</p><p>Application Admins should have write permissions on the Gateway resource, but only in their specific namespaces, and Application Developers should only hold write permissions on Route resources. To enact this access control schema, follow the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#write-permissions-for-advanced-4-tier-model>Write Permissions for Advanced 4 Tier Model</a> described in the Kubernetes Gateway API security model. Examples of secured gateway-route topologies can be found <a href=https://gateway-api.sigs.k8s.io/concepts/api-overview/#attaching-routes-to-gateways>here</a> within the Kubernetes Gateway API docs.</p><p>Optionally, consider a GitOps model, where only the GitOps operator has the permission to deploy or modify custom resources in production.</p><h3 id=egtm-014-malicious-image-admission>EGTM-014 Malicious image admission<a class=td-heading-self-link href=#egtm-014-malicious-image-admission aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-014</td><td>EGTM-CS-006</td><td>Container Security</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a supply chain attack on Envoy Gateway results in an arbitrary compromise of the confidentiality, integrity or availability of tenant data.</p><p><strong>Threat</strong>: Supply chain threat actor introduces malicious code into Envoy Gateway or Proxy.</p><p><strong>Recommendation</strong>: The Envoy Gateway project should continue to work towards conformance with supply-chain security best practices throughout the project lifecycle (for example, as set out in the <a href=https://github.com/cncf/tag-security/blob/main/supply-chain-security/supply-chain-security-paper/CNCF_SSCP_v1.pdf>CNCF Software Supply Chain Best Practices Whitepaper</a>). Adherence to <a href=https://slsa.dev/>Supply-chain Levels for Software Artefacts</a> (SLSA) standards is crucial for maintaining the security of the system. Employ version control systems to monitor the source and build platforms and assign responsibility to a specific stakeholder.</p><p>Integrate a supply chain security tool such as Sigstore, which provides native capabilities for signing and verifying container images and software artefacts. <a href=https://www.cisa.gov/sbom>Software Bill of Materials</a> (SBOM), <a href=https://www.ntia.gov/files/ntia/publications/vex_one-page_summary.pdf>Vulnerability Exploitability eXchange</a> (VEX), and signed artefacts should also be incorporated into the security protocol.</p><h3 id=egtm-020-out-of-date-or-misconfigured-envoy-proxy-image>EGTM-020 Out of date or misconfigured Envoy Proxy image<a class=td-heading-self-link href=#egtm-020-out-of-date-or-misconfigured-envoy-proxy-image aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-020</td><td>EGTM-CS-009</td><td>Container Security</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor exploits an Envoy Proxy vulnerability to remote code execution (RCE) due to out of date or misconfigured Envoy Proxy pod deployment, compromising the confidentiality and integrity of Envoy Proxy along with the availability of the proxy service.</p><p><strong>Threat</strong>: Deployment of an Envoy Proxy or Gateway image containing exploitable CVEs.</p><p><strong>Recommendation</strong>: Always use the latest version of the Envoy Proxy image. Regularly check for updates and patch the system as soon as updates become available. Implement a CI/CD pipeline that includes security checks for images and prevents deployment of insecure configurations. A suitable tool should be chosen to provide container vulnerability scanning to mitigate the risk of known vulnerabilities.</p><p>Utilise the <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/>Pod Security Admission</a> controller to enforce <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/>Pod Security Standards</a> and configure the <a href=https://kubernetes.io/docs/tasks/configure-pod-container/security-context/>pod security context</a> to limit its capabilities per the principle of least privilege.</p><h3 id=egtm-022-credentials-are-stored-as-kubernetes-secrets>EGTM-022 Credentials are stored as Kubernetes Secrets<a class=td-heading-self-link href=#egtm-022-credentials-are-stored-as-kubernetes-secrets aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-022</td><td>EGTM-CS-010</td><td>Container Security</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that the OIDC client secret (for OIDC authentication) and user password hashes (for basic authentication) get leaked due to misconfigured RBAC permissions.</p><p><strong>Threat</strong>: Unauthorised access to the application due to credential leakage.</p><p><strong>Recommendation</strong>: Ensure that only authorised users and service accounts are able to access secrets. This is especially important in namespaces where SecurityPolicy objects are configured, since those namespaces are the ones to store secrets containing the client secret (in OIDC scenarios) and user password hashes (in basic authentication scenarios).</p><p>To do so, minimise the use of ClusterRoles and Roles allowing listing and getting secrets. Perform periodic audits of RBAC permissions.</p><h3 id=egtm-023-weak-authentication>EGTM-023 Weak Authentication<a class=td-heading-self-link href=#egtm-023-weak-authentication aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-023</td><td>EGTM-EG-007</td><td>Envoy Gateway</td><td>High</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk of unauthorised access due to the use of basic authentication, which does not enforce any password restriction in terms of complexity and length. In addition, password hashes are stored in SHA1 format, which is a deprecated hashing function.</p><p><strong>Threat</strong>: Unauthorised access to the application due to weak authentication mechanisms.</p><p><strong>Recommendation</strong>: It is recommended to make use of stronger authentication mechanisms (i.e. JWT authentication and OIDC authentication) instead of basic authentication. These authentication mechanisms have many advantages, such as the use of short-lived credentials and a central management of security policies through the identity provider.</p><h2 id=medium-priority-findings>Medium Priority Findings<a class=td-heading-self-link href=#medium-priority-findings aria-label="Heading self-link"></a></h2><h3 id=egtm-008-misconfiguration-of-envoy-gateway-static-config>EGTM-008 Misconfiguration of Envoy Gateway static config<a class=td-heading-self-link href=#egtm-008-misconfiguration-of-envoy-gateway-static-config aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-008</td><td>EGTM-EG-003</td><td>Envoy Gateway</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk of a threat actor misconfiguring static config and compromising the integrity of Envoy Gateway, ultimately leading to the compromised confidentiality, integrity, or availability of tenant data and cluster resources.</p><p><strong>Threat</strong>: Accidental or deliberate misconfiguration of static configuration leads to a misconfigured deployment of Envoy Gateway, for example logging parameters could be modified or global rate limiting configuration misconfigured.</p><p><strong>Recommendation</strong>: Implement a GitOps model, utilising Kubernetes' Role-Based Access Control (RBAC) and adhering to the principle of least privilege to minimise human intervention on the cluster. For instance, tools like <a href=https://fluxcd.io/>Flux</a> and <a href=https://argo-cd.readthedocs.io/en/stable/>ArgoCD</a> can be used for declarative GitOps deployments, ensuring all changes are tracked and reviewed. Additionally, configure your source control management (SCM) system to include mandatory pull request (PR) reviews, commit signing, and protected branches to ensure only authorised changes can be committed to the start-up configuration.</p><h3 id=egtm-010-weak-pod-security-contexts-and-policies>EGTM-010 Weak pod security contexts and policies<a class=td-heading-self-link href=#egtm-010-weak-pod-security-contexts-and-policies aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-010</td><td>EGTM-CS-005</td><td>Container Security</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor exploits a weak pod security context, compromising the CIA of a node and the resources / services which run on it.</p><p><strong>Threat</strong>: Threat Actor who has compromised a pod exploits weak security context to escape to a node, potentially leading to the compromise of Envoy Proxy or Gateway running on the same node.</p><p><strong>Recommendation</strong>: To mitigate this risk, apply <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/>Pod Security Standards</a> at a minimum of <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline>Baseline</a> level to all namespaces, especially those containing Envoy Gateway and Proxy Pods. Pod security standards are implemented through K8s <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/>Pod Security Admission</a> to provide <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/#pod-security-admission-labels-for-namespaces>admission control modes</a> (enforce, audit, and warn) for namespaces. Pod security standards can be enforced by namespace labels as shown <a href=https://kubernetes.io/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/>here</a>, to enforce a baseline level of pod security to specific namespaces.</p><p>Further enhance the security by implementing a sandboxing solution such as <a href=https://gvisor.dev/>gVisor</a> for Envoy Gateway and Proxy Pods to isolate the application from the host kernel. This can be set within the runtimeClassName of the Pod specification.</p><h3 id=egtm-012-clusterroles-and-roles-with-permission-to-deploy-referencegrants>EGTM-012 ClusterRoles and Roles with permission to deploy ReferenceGrants<a class=td-heading-self-link href=#egtm-012-clusterroles-and-roles-with-permission-to-deploy-referencegrants aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-012</td><td>EGTM-GW-004</td><td>Gateway API</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor could abuse excessive RBAC privileges to create ReferenceGrant resources. These resources could then be used to create cross-namespace communication, leading to unauthorised access to the application. This could compromise the confidentiality and integrity of resources and configuration in the affected namespaces and potentially disrupt the availability of services that rely on these object references.</p><p><strong>Threat</strong>: A ReferenceGrant is created, which validates traffic to cross namespace trust boundaries without a valid business reason, such as a route in one tenant's namespace referencing a backend in another.</p><p><strong>Recommendation</strong>: Ensure that the ability to create ReferenceGrant resources is restricted to the minimum number of people. Pay special attention to ClusterRoles that allow that action.</p><h3 id=egtm-018-network-denial-of-service-dos>EGTM-018 Network Denial of Service (DoS)<a class=td-heading-self-link href=#egtm-018-network-denial-of-service-dos aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-018</td><td>EGTM-GW-006</td><td>Gateway API</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that malicious requests could lead to a Denial of Service (DoS) attack, thereby reducing API gateway availability due to misconfigurations in rate-limiting or load balancing controls, or a lack of route timeout enforcement.</p><p><strong>Threat</strong>: Reduced API gateway availability due to an attacker's maliciously crafted request (e.g., QoD) potentially inducing a Denial of Service (DoS) attack.</p><p><strong>Recommendation</strong>: To ensure high availability and to mitigate potential security threats, adhere to the Envoy Gateway documentation for the configuration of a <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/global-rate-limit/>rate-limiting</a> filter and load balancing.</p><p>Further, adhere to best practices for configuring Envoy Proxy as an edge proxy documented <a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge#configuring-envoy-as-an-edge-proxy>here</a> within the EnvoyProxy docs. This involves configuring TCP and HTTP proxies with specific settings, including restricting access to the admin endpoint, setting the <a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/operations/overload_manager/overload_manager#config-overload-manager>overload manager</a> and <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/listener/v3/listener.proto#envoy-v3-api-field-config-listener-v3-listener-per-connection-buffer-limit-bytes>listener</a> / <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/cluster.proto#envoy-v3-api-field-config-cluster-v3-cluster-per-connection-buffer-limit-bytes>cluster</a> buffer limits, enabling <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-use-remote-address>use_remote_address</a>, setting <a href=https://www.envoyproxy.io/docs/envoy/latest/faq/configuration/timeouts#faq-configuration-timeouts>connection and stream timeouts</a>, limiting <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-http2protocoloptions-max-concurrent-streams>maximum concurrent streams</a>, setting <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-http2protocoloptions-initial-stream-window-size>initial stream window size limit</a>, and configuring action on <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-httpprotocoloptions-headers-with-underscores-action>headers_with_underscores</a>.</p><p><a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path>Path normalisation</a> should be enabled to minimise path confusion vulnerabilities. These measures help protect against volumetric threats such as Denial of Service (DoS) attacks. Utilise custom resources to implement policy attachment, thereby exposing request limit configuration for route types.</p><h3 id=egtm-019-jwt-based-authentication-replay-attacks>EGTM-019 JWT-based authentication replay attacks<a class=td-heading-self-link href=#egtm-019-jwt-based-authentication-replay-attacks aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-019</td><td>EGTM-DP-004</td><td>Container Security</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that replay attacks using stolen or reused JSON Web Tokens (JWTs) can compromise transmission integrity, thereby undermining the confidentiality and integrity of the data plane.</p><p><strong>Threat</strong>: Transmission integrity is compromised due to replay attacks using stolen or reused JSON Web Tokens (JWTs).</p><p><strong>Recommendation</strong>: Comply with JWT best practices for enhanced security, paying special attention to the use of short-lived tokens, which reduce the window of opportunity for a replay attack. The <a href=https://datatracker.ietf.org/doc/html/rfc7519#page-9>exp</a> claim can be used to set token expiration times.</p><h3 id=egtm-024-excessive-privileges-via-extension-policies>EGTM-024 Excessive privileges via extension policies<a class=td-heading-self-link href=#egtm-024-excessive-privileges-via-extension-policies aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-024</td><td>EGTM-EG-008</td><td>Envoy Gateway</td><td>Medium</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk of developers getting more privileges than required due to the use of SecurityPolicy, ClientTrafficPolicy, EnvoyPatchPolicy and BackendTrafficPolicy. These resources can be attached to a Gateway resource. Therefore, a developer with permission to deploy them would be able to modify a Gateway configuration by targeting the gateway in the policy manifest. This conflicts with the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#write-permissions-for-advanced-4-tier-model>Advanced 4 Tier Model</a>, where developers do not have write permissions on Gateways.</p><p><strong>Threat</strong>: Excessive developer permissions lead to a misconfiguration and/or unauthorised access.</p><p><strong>Recommendation</strong>: Considering the Tenant C scenario (represented in the Architecture Diagram), if a developer can create SecurityPolicy, ClientTrafficPolicy, EnvoyPatchPolicy or BackendTrafficPolicy objects in namespace C, they would be able to modify a Gateway configuration by attaching the policy to the gateway. In such scenarios, it is recommended to either:</p><p>a. Create a separate namespace, where developers have no permissions, to host tenant C's gateway. Note that, due to design decisions, the SecurityPolicy/EnvoyPatchPolicy/ClientTrafficPolicy/BackendTrafficPolicy object can only target resources deployed in the same namespace. Therefore, having a separate namespace for the gateway would prevent developers from attaching the policy to the gateway.</p><p>b. Forbid the creation of these policies for developers in namespace C.</p><p>On the other hand, in scenarios similar to tenants A and B, where a shared gateway namespace is in place, this issue is more limited. Note that in this scenario, developers don't have access to the shared gateway namespace.</p><p>In addition, it is important to mention that EnvoyPatchPolicy resources can also be attached to GatewayClass resources. This means that, in order to comply with the Advanced 4 Tier model, individuals with the Application Administrator role should not have access to this resource either.</p><h2 id=low-priority-findings>Low Priority Findings<a class=td-heading-self-link href=#low-priority-findings aria-label="Heading self-link"></a></h2><h3 id=egtm-003-misconfiguration-leads-to-insecure-tls-settings>EGTM-003 Misconfiguration leads to insecure TLS settings<a class=td-heading-self-link href=#egtm-003-misconfiguration-leads-to-insecure-tls-settings aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-003</td><td>EGTM-EG-001</td><td>Envoy Gateway</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor could downgrade the security of proxied connections by configuring a weak set of cipher suites, compromising the confidentiality and integrity of proxied traffic.</p><p><strong>Threat</strong>: Exploit weak cipher suite configuration to downgrade security of proxied connections.</p><p><strong>Recommendation</strong>: Users operating in highly regulated environments may need to tightly control the TLS protocol and associated cipher suites, blocking non-conforming incoming connections to the gateway.</p><p>EnvoyProxy bootstrap config can be customised as per the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/customize-envoyproxy/>customise EnvoyProxy</a> documentation. In addition, from v.1.0.0, it is possible to configure common TLS properties for a Gateway or XRoute through the <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#clienttrafficpolicy>ClientTrafficPolicy</a> object.</p><h3 id=egtm-005-envoy-gateway-helm-chart-deployment-does-not-set-apparmor-and-seccomp-profiles>EGTM-005 Envoy Gateway Helm chart deployment does not set AppArmor and Seccomp profiles<a class=td-heading-self-link href=#egtm-005-envoy-gateway-helm-chart-deployment-does-not-set-apparmor-and-seccomp-profiles aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-005</td><td>EGTM-CP-002</td><td>Container Security</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: Threat actor who has obtained access to Envoy Gateway pod could exploit the lack of AppArmor and Seccomp profiles in the Envoy Gateway deployment to attempt a container breakout, given the presence of an exploitable vulnerability, potentially impacting the confidentiality and integrity node resources.</p><p><strong>Threat</strong>: Unauthorised syscalls and malicious code running in the Envoy Gateway pod.</p><p><strong>Recommendation</strong>: Implement <a href=https://kubernetes.io/docs/tutorials/security/apparmor/>AppArmor</a> policies by setting &lt;container_name>: &lt;profile_ref> within container.apparmor.security.beta.kubernetes.io (note, this config is set <em>per container</em>). Well-defined AppArmor policies may provide greater protection from unknown threats.</p><p>Enforce <a href=https://kubernetes.io/docs/tutorials/security/seccomp/>Seccomp</a> profiles by setting the seccompProfile under securityContext. Ideally, a <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-with-a-seccomp-profile-that-only-allows-necessary-syscalls>fine-grained</a> profile should be used to restrict access to only necessary syscalls, however the --seccomp-default flag can be set to resort to <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile>RuntimeDefault</a> which provides a container runtime specific. Example seccomp profiles can be found <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#download-profiles>here</a>.</p><p>To further enhance pod security, consider implementing <a href=https://en.wikipedia.org/wiki/Security-Enhanced_Linux>SELinux</a> via seLinuxOptions for additional syscall attack surface reduction. Setting readOnlyRootFilesystem == true enforces an immutable root filesystem, preventing the addition of malicious binaries to the PATH and increasing the attack cost. Together, these configuration items improve the pods <a href=https://kubernetes.io/docs/tasks/configure-pod-container/security-context/>Security Context</a>.</p><h3 id=egtm-006-envoy-proxy-pods-deployed-with-a-shell-enabled>EGTM-006 Envoy Proxy pods deployed with a shell enabled<a class=td-heading-self-link href=#egtm-006-envoy-proxy-pods-deployed-with-a-shell-enabled aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-006</td><td>EGTM-CS-004</td><td>Container Security</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a threat actor exploits a vulnerability in Envoy Proxy to expose a reverse shell, enabling them to compromise the confidentiality, integrity and availability of tenant data via a secondary attack.</p><p><strong>Threat</strong>: If an external attacker managed to exploit a vulnerability in Envoy, the presence of a shell would be greatly helpful for the attacker in terms of potentially pivoting, escalating, or establishing some form of persistence.</p><p><strong>Recommendation</strong>: By default, Envoy uses a <a href=https://github.com/GoogleContainerTools/distroless>distroless</a> image since v.0.6.0, which does not ship a shell. Therefore, ensure EnvoyProxy image is up-to-date and patched with the latest stable version.</p><p>If using private EnvoyProxy images, use a lightweight EnvoyProxy image without a shell or debugging tool(s) which may be useful for an attacker.</p><p>An <a href=https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/#audit-policy>AuditPolicy</a> (audit.k8s.io/v1beta1) can be configured to record API calls made within your cluster, allowing for identification of malicious traffic and enabling incident response. Requests are recorded based on stages which delineate between the lifecycle stage of the request made (e.g., RequestReceived, ResponseStarted, & ResponseComplete).</p><h3 id=egtm-011-route-bindings-on-custom-labels>EGTM-011 Route Bindings on custom labels<a class=td-heading-self-link href=#egtm-011-route-bindings-on-custom-labels aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-011</td><td>EGTM-GW-003</td><td>Gateway API</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that a gateway owner (or someone with the ability to set namespace labels) maliciously or accidentally binds routes across namespace boundaries, potentially compromising the confidentiality and integrity of traffic in a multitenant scenario.</p><p><strong>Threat</strong>: If a Route Binding within a Gateway Listener is configured based on a custom label, it could allow a malicious internal actor with the ability to label namespaces to change the set of namespaces supported by the Gateway.</p><p><strong>Recommendation</strong>: Consider the use of custom admission control to restrict what labels can be set on namespaces through tooling such as <a href=https://kyverno.io/policies/pod-security/>Kubewarden</a>, <a href=https://github.com/kubewarden>Kyverno</a>, and <a href=https://github.com/open-policy-agent/gatekeeper>OPA Gatekeeper</a>. Route binding should follow the Kubernetes Gateway API security model, as shown <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#1-route-binding>here</a>, to connect gateways in different namespaces.</p><h3 id=egtm-013-gatewayclass-namespace-validation-is-not-configured>EGTM-013 GatewayClass namespace validation is not configured<a class=td-heading-self-link href=#egtm-013-gatewayclass-namespace-validation-is-not-configured aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-013</td><td>EGTM-GW-005</td><td>Gateway API</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that an unauthorised actor deploys an unauthorised GatewayClass due to GatewayClass namespace validation not being configured, leading to non-compliance with business and security requirements.</p><p><strong>Threat</strong>: Unauthorised deployment of Gateway resource via GatewayClass template which crosses namespace trust boundaries.</p><p><strong>Recommendation</strong>: Leverage GatewayClass namespace validation to limit the namespaces where GatewayClasses can be run through a tool such as <a href=https://github.com/open-policy-agent/gatekeeper>OPA Gatekeeper</a>. Reference pull request #<a href=https://github.com/open-policy-agent/gatekeeper-library/pull/24>24</a> within gatekeeper-library which outlines how to add GatewayClass namespace validation through a GatewayClassNamespaces API resource kind within the constraints.gatekeeper.sh/v1beta1 apiGroup.</p><h3 id=egtm-015-serviceaccount-token-authentication>EGTM-015 ServiceAccount token authentication<a class=td-heading-self-link href=#egtm-015-serviceaccount-token-authentication aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-015</td><td>EGTM-CS-007</td><td>Container Security</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that threat actors could exploit ServiceAccount tokens for illegitimate authentication, thereby leading to privilege escalation and the undermining of gateway API resources' integrity, confidentiality, and availability.</p><p><strong>Threat</strong>: The threat arises from threat actors impersonating the envoy-gateway ServiceAccount through the replay of ServiceAccount tokens, thereby achieving escalated privileges and gaining unauthorised access to Kubernetes resources.</p><p><strong>Recommendation</strong>: Limit the creation of ServiceAccounts to only when necessary, specifically refraining from using default service account tokens, especially for high-privilege service accounts. For legacy clusters running Kubernetes version 1.21 or earlier, note that ServiceAccount tokens are long-lived by default. To disable the automatic mounting of the service account token, set automountServiceAccountToken: false in the PodSpec.</p><h3 id=egtm-016-misconfiguration-leads-to-lack-of-envoy-proxy-access-activity-visibility>EGTM-016 Misconfiguration leads to lack of Envoy Proxy access activity visibility<a class=td-heading-self-link href=#egtm-016-misconfiguration-leads-to-lack-of-envoy-proxy-access-activity-visibility aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-016</td><td>EGTM-EG-004</td><td>Envoy Gateway</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that threat actors establish persistence and move laterally through the cluster unnoticed due to limited visibility into access and application-level activity.</p><p><strong>Threat</strong>: Threat actors establish persistence and move laterally through the cluster unnoticed.</p><p><strong>Recommendation</strong>: Configure <a href=/eg-pr-preview/6-test-preview/contributions/design/proxy-accesslog/>access logging</a> in the EnvoyProxy. Use <a href=/eg-pr-preview/6-test-preview/v1.0/api/extension_types/#proxyaccesslogformattype>ProxyAccessLogFormatType</a> (Text or JSON) to specify the log format and ensure that the logs are sent to the desired sink types by setting the <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#proxyaccesslogsinktype>ProxyAccessLogSinkType</a>. Make use of <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#fileenvoyproxyaccesslog>FileEnvoyProxyAccessLog</a> or <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#opentelemetryenvoyproxyaccesslog>OpenTelemetryEnvoyProxyAccessLog</a> to configure File and OpenTelemetry sinks, respectively. If the settings aren't defined, the default format is sent to stdout.</p><p>Additionally, consider leveraging a central logging mechanism such as <a href=https://github.com/fluent/fluentd>Fluentd</a> to enhance visibility into access activity and enable effective incident response (IR).</p><h3 id=egtm-017-misconfiguration-leads-to-lack-of-envoy-gateway-activity-visibility>EGTM-017 Misconfiguration leads to lack of Envoy Gateway activity visibility<a class=td-heading-self-link href=#egtm-017-misconfiguration-leads-to-lack-of-envoy-gateway-activity-visibility aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-017</td><td>EGTM-EG-005</td><td>Envoy Gateway</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that an insider misconfigures an envoy gateway component and goes unnoticed due to a low-touch logging configuration (via default) which responsible stakeholders are not aptly aware of or have immediate access to.</p><p><strong>Threat</strong>: The threat emerges from an insider misconfiguring an Envoy Gateway component without detection.</p><p><strong>Recommendation</strong>: Configure the logging level of the Envoy Gateway using the 'level' field in <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#envoygatewaylogging>EnvoyGatewayLogging</a>. Ensure the appropriate logging levels are set for relevant components such as 'gateway-api', 'xds-translator', or 'global-ratelimit'. If left unspecified, the logging level defaults to "info", which may not provide sufficient detail for security monitoring.</p><p>Employ a centralised logging mechanism, like <a href=https://github.com/fluent/fluentd>Fluentd</a>, to enhance visibility into application-level activity and to enable efficient incident response.</p><h3 id=egtm-021-exposed-envoy-proxy-admin-interface>EGTM-021 Exposed Envoy Proxy admin interface<a class=td-heading-self-link href=#egtm-021-exposed-envoy-proxy-admin-interface aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-021</td><td>EGTM-EG-006</td><td>Envoy Gateway</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: There is a risk that the admin interface is exposed without valid business reason, increasing the attack surface.</p><p><strong>Threat</strong>: Exposed admin interfaces give internal attackers the option to affect production traffic in unauthorised ways, and the option to exploit any vulnerabilities which may be present in the admin interface (e.g. by orchestrating malicious GET requests to the admin interface through CSRF, compromising Envoy Proxy global configuration or shutting off the service entirely e.g. /quitquitquit).</p><p><strong>Recommendation</strong>: The Envoy Proxy admin interface is only exposed to localhost, meaning that it is secure by default. However, due to the risk of misconfiguration, this recommendation is included.</p><p>Due to the importance of the admin interface, it is recommended to ensure that Envoy Proxies have not been accidentally misconfigured to expose the admin interface to untrusted networks.</p><h3 id=egtm-025-envoy-proxy-pods-deployed-running-as-root-user-in-the-container>EGTM-025 Envoy Proxy pods deployed running as root user in the container<a class=td-heading-self-link href=#egtm-025-envoy-proxy-pods-deployed-running-as-root-user-in-the-container aria-label="Heading self-link"></a></h3><table><thead><tr><th><strong>ID</strong></th><th><strong>UID</strong></th><th><strong>Category</strong></th><th><strong>Priority</strong></th></tr></thead><tbody><tr><td>EGTM-025</td><td>EGTM-CS-011</td><td>Container Security</td><td>Low</td></tr></tbody></table><p><strong>Risk</strong>: The presence of a vulnerability, be it in the kernel or another system component, when coupled with containers running as root, could enable a threat actor to escape the container, thereby compromising the confidentiality, integrity, or availability of cluster resources</p><p><strong>Threat</strong>: The Envoy Proxy container&rsquo;s root-user configuration can be leveraged by an attacker to escalate privileges, execute a container breakout, and traverse across trust boundaries.</p><p><strong>Recommendation</strong>: By default, Envoy Gateway deployments do not use root users. Nonetheless, in case a custom image or deployment manifest is to be used, make sure Envoy Proxy pods run as a non-root user with a high UID within the container.</p><p>Set runAsUser and runAsGroup security context options to specific UIDs (e.g., runAsUser: 1000 & runAsGroup: 3000) to ensure the container operates with the stipulated non-root user and group ID. If using helm chart deployment, define the user and group ID in the values.yaml file or via the command line during helm install / upgrade.</p><h2 id=appendix>Appendix<a class=td-heading-self-link href=#appendix aria-label="Heading self-link"></a></h2><h3 id=in-scope-threat-actor-details>In Scope Threat Actor Details<a class=td-heading-self-link href=#in-scope-threat-actor-details aria-label="Heading self-link"></a></h3><table><thead><tr><th>Threat Actor</th><th>Capability</th><th>Personal Motivation</th><th>Envoy Gateway Attack Samples</th></tr></thead><tbody><tr><td>Application Developer</td><td>Leverage internal knowledge and personal access to the Envoy Gateway infrastructure to move laterally and transit trust boundaries</td><td>Disgruntled / personal grievances.<br><br>Financial incentives</td><td>Misconfigure XRoute resources to expose internal applications.<br><br>Misconfigure SecurityPolicy objects, reducing the security posture of an application.</td></tr><tr><td>Application Administrator</td><td>Abuse privileged status to disrupt operations and tenant cluster services through Envoy Gateway misconfig</td><td>Disgruntled / personal grievances.<br><br>Financial incentives</td><td>Create malicious routes to internal applications.<br><br>Introduce malicious Envoy Proxy images.<br><br>Expose the Envoy Proxy Admin interface.</td></tr><tr><td>Cluster Operator</td><td>Alter application-level deployments by misconfiguring resource dependencies & SCM to introduce vulnerabilities</td><td>Disgruntled / personal grievances.<br><br>Financial incentives.<br><br>Notoriety</td><td>Deploy malicious resources to expose internal applications.<br><br>Access authentication secrets.<br><br>Fall victim to phishing attacks and inadvertently share authentication credentials to cloud infrastructure or Kubernetes clusters.</td></tr><tr><td>Vandal: Script Kiddie, Trespasser</td><td>Uses publicly available tools and applications (Nmap,Metasploit, CVE PoCs)</td><td>Curiosity.<br><br>Personal fame through defacement / denial of service of prominent public facing web resources</td><td>Small scale DOS.<br><br>Launches prepackaged exploits, runs crypto mining tools.<br><br>Exploit public-facing application services such as the bastion host to gain an initial foothold in the environment</td></tr><tr><td>Motivated individual: Political activist, Thief, Terrorist</td><td>Write tools and exploits required for their means if sufficiently motivated.<br><br>Tend to use these in a targeted fashion against specific organisations. May combine publicly available exploits in a targeted fashion. Tamper with open source supply chains</td><td>Personal Gain (Political or Ideological)</td><td>Phishing, DDOS, exploit known vulnerabilities.<br><br>Compromise third-party components such as Helm charts and container images to inject malicious codes to propagate access throughout the environment.</td></tr><tr><td>Organised crime: syndicates, state-affiliated groups</td><td>Write tools and exploits required for their means.<br><br>Tend to use these in a non-targeted fashion, unless motivation is sufficiently high.<br><br>Devotes considerable resources, writes exploits, can bribe/coerce, can launch targeted attacks</td><td>Ransom.<br><br>Mass extraction of PII / credentials / PCI data.<br><br>Financial incentives</td><td>Social Engineering, phishing, ransomware, coordinated attacks.<br><br>Intercept and replay JWT tokens (via MiTM) between tenant user(s) and envoy gateway to modify app configs in-transit</td></tr></tbody></table><h3 id=identified-threats-by-priority>Identified Threats by Priority<a class=td-heading-self-link href=#identified-threats-by-priority aria-label="Heading self-link"></a></h3><table><thead><tr><th>ID</th><th>UID</th><th>Category</th><th>Risk</th><th>Threat</th><th>Priority</th><th>Recommendation</th></tr></thead><tbody><tr><td>EGTM-001</td><td>EGTM-GW-001</td><td>Gateway API</td><td>Self-signed certificates (which do not comply with PKI best practices) could lead to unauthorised access to the private key associated with the certificate used for inbound TLS termination at Envoy Proxy, compromising the confidentiality and integrity of proxied traffic.<br><br></td><td>Compromise of the private key associated with the certificate used for inbound TLS terminating at Envoy Proxy.<br><br></td><td>High</td><td>The Envoy Gateway quickstart guide demonstrates how to set up a Secure Gateway using an example where a self-signed root certificate is created using openssl. As stated in the Envoy Gateway documentation, this is not a suitable configuration for Production usage. It is recommended that PKI best practices are followed, whereby certificates are signed by an Intermediary CA which sits underneath an organisational 'offline' Root CA.<br><br>PKI best practices should also apply to the management of client certificates when using mTLS. The Envoy Gateway <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/security/mutual-tls/>mTLS</a> guide shows how to set up client certificates using self-signed certificates. In the same way as gateway certificates and, as mentioned in the documentation, this configuration should not be used in production environments.</td></tr><tr><td>EGTM-002</td><td>EGTM-CS-001</td><td>Container Security</td><td>There is a risk that a threat actor could compromise the Kubernetes secret containing the Envoy private key, allowing the attacker to decrypt Envoy Proxy traffic, compromising the confidentiality of proxied traffic.<br><br></td><td>Kubernetes secret containing the Envoy private key is compromised and used to decrypt proxied traffic.<br><br></td><td>High</td><td>Certificate management best practices mandate short-lived key material where practical, meaning that a mechanism for rotation of private keys and certificates is required, along with a way for certificates to be mounted into Envoy containers. If Kubernetes secrets are used, when a certificate expires, the associated secret must be updated, and Envoy containers must be redeployed. Instead of a manual configuration, it is recommended that <a href=https://github.com/cert-manager/cert-manager>cert-manager</a> is used.</td></tr><tr><td>EGTM-004</td><td>EGTM-K8-002</td><td>Container Security</td><td>There is a risk that a threat actor could abuse misconfigured RBAC to access the Envoy Gateway ClusterRole (envoy-gateway-role) and use it to expose all secrets across the cluster, thus compromising the confidentiality and integrity of tenant data.<br><br></td><td>Compromised Envoy Gateway or misconfigured ClusterRoleBinding (envoy-gateway-rolebinding) to Envoy Gateway ClusterRole (envoy-gateway-role), provides access to resources and secrets in different namespaces.<br><br></td><td>High</td><td>Users should be aware that Envoy Gateway uses a ClusterRole (envoy-gateway-role) when deployed via the Helm chart, to allow management of Envoy Proxies across different namespaces. This ClusterRole is powerful and includes the ability to read secrets in namespaces which may not be within the purview of Envoy Gateway.<br><br>Kubernetes best-practices involve restriction of ClusterRoleBindings, with the use of RoleBindings where possible to limit access per namespace by specifying the namespace in metadata. Namespace isolation reduces the impact of compromise from cluster-scoped roles. Ideally, fine-grained K8s roles should be created per the principle of least privilege to ensure they have the minimum access necessary for role functions.<br><br>The pull request #<a href=https://github.com/envoyproxy/gateway/pull/1656>1656</a> introduced the use of Roles and RoleBindings in <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#kuberneteswatchmode>namespaced mode</a>. This feature can be leveraged to reduce the amount of permissions required by the Envoy Gateway.</td></tr><tr><td>EGTM-007</td><td>EGTM-EG-002</td><td>Envoy Gateway</td><td>There is a risk that a threat actor could exploit misconfigured Kubernetes RBAC to create or modify Gateway API resources with no business need, potentially leading to the compromise of the confidentiality, integrity, and availability of resources and traffic within the cluster.<br><br></td><td>Unauthorised creation or misconfiguration of Gateway API resources by a threat actor with cluster-scoped access.<br><br></td><td>High</td><td>Configure the apiGroup and resource fields in RBAC policies to restrict access to <a href=https://gateway-api.sigs.k8s.io/>Gateway</a> and <a href=https://gateway-api.sigs.k8s.io/api-types/gatewayclass/>GatewayClass</a> resources. Enable namespace isolation by using the namespace field, preventing unauthorised access to gateways in other namespaces.</td></tr><tr><td>EGTM-009</td><td>EGTM-GW-002</td><td>Gateway API</td><td>There is a risk that a co-tenant misconfigures Gateway or Route resources, compromising the confidentiality, integrity, and availability of routed traffic through Envoy Gateway.<br><br></td><td>Malicious or accidental co-tenant misconfiguration of Gateways and Routes associated with other application teams.<br><br></td><td>High</td><td>Dedicated Envoy Gateways should be provided to each tenant within their respective namespace. A one-to-one relationship should be established between GatewayClass and Gateway resources, meaning that each tenant namespace should have their own GatewayClass watched by a unique Envoy Gateway Controller as defined here in the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/deployment-mode/>Deployment Mode</a> documentation.<br><br>Application Admins should have write permissions on the Gateway resource, but only in their specific namespaces, and Application Developers should only hold write permissions on Route resources. To enact this access control schema, follow the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#write-permissions-for-advanced-4-tier-model>Write Permissions for Advanced 4 Tier Model</a> described in the Kubernetes Gateway API security model. Examples of secured gateway-route topologies can be found <a href=https://gateway-api.sigs.k8s.io/concepts/api-overview/#attaching-routes-to-gateways>here</a> within the Kubernetes Gateway API docs.<br><br>Optionally, consider a GitOps model, where only the GitOps operator has the permission to deploy or modify custom resources in production.</td></tr><tr><td>EGTM-014</td><td>EGTM-CS-006</td><td>Container Security</td><td>There is a risk that a supply chain attack on Envoy Gateway results in an arbitrary compromise of the confidentiality, integrity or availability of tenant data.<br><br></td><td>Supply chain threat actor introduces malicious code into Envoy Gateway or Proxy.<br><br></td><td>High</td><td>The Envoy Gateway project should continue to work towards conformance with supply-chain security best practices throughout the project lifecycle (for example, as set out in the <a href=https://github.com/cncf/tag-security/blob/main/supply-chain-security/supply-chain-security-paper/CNCF_SSCP_v1.pdf>CNCF Software Supply Chain Best Practices Whitepaper</a>. Adherence to <a href=https://slsa.dev/>Supply-chain Levels for Software Artefacts</a> (SLSA) standards is crucial for maintaining the security of the system. Employ version control systems to monitor the source and build platforms and assign responsibility to a specific stakeholder.<br><br>Integrate a supply chain security tool such as Sigstore, which provides native capabilities for signing and verifying container images and software artefacts. <a href=https://www.cisa.gov/sbom>Software Bill of Materials</a> (SBOM), <a href=https://www.ntia.gov/files/ntia/publications/vex_one-page_summary.pdf>Vulnerability Exploitability eXchange</a> (VEX), and signed artefacts should also be incorporated into the security protocol.</td></tr><tr><td>EGTM-020</td><td>EGTM-CS-009</td><td>Container Security</td><td>There is a risk that a threat actor exploits an Envoy Proxy vulnerability to remote code execution (RCE) due to out of date or misconfigured Envoy Proxy pod deployment, compromising the confidentiality and integrity of Envoy Proxy along with the availability of the proxy service.<br><br></td><td>Deployment of an Envoy Proxy or Gateway image containing exploitable CVEs.<br><br></td><td>High</td><td>Always use the latest version of the Envoy Proxy image. Regularly check for updates and patch the system as soon as updates become available. Implement a CI/CD pipeline that includes security checks for images and prevents deployment of insecure configurations. A tool such as Snyk can be used to provide container vulnerability scanning to mitigate the risk of known vulnerabilities.<br><br>Utilise the <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/>Pod Security Admission</a> controller to enforce <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/>Pod Security Standards</a> and configure the <a href=https://kubernetes.io/docs/tasks/configure-pod-container/security-context/>pod security context</a> to limit its capabilities per the principle of least privilege.</td></tr><tr><td>EGTM-022</td><td>EGTM-CS-010</td><td>Container Security</td><td>There is a risk that the OIDC client secret (for OIDC authentication) and user password hashes (for basic authentication) get leaked due to misconfigured RBAC permissions.<br><br></td><td>Unauthorised access to the application due to credential leakage.<br><br></td><td>High</td><td>Ensure that only authorised users and service accounts are able to access secrets. This is especially important in namespaces where SecurityPolicy objects are configured, since those namespaces are the ones to store secrets containing the client secret (in OIDC scenarios) and user password hashes (in basic authentication scenarios).<br><br>To do so, minimise the use of ClusterRoles and Roles allowing listing and getting secrets. Perform periodic audits of RBAC permissions.</td></tr><tr><td>EGTM-023</td><td>EGTM-EG-007</td><td>Envoy Gateway</td><td>There is a risk of unauthorised access due to the use of basic authentication, which does not enforce any password restriction in terms of complexity and length. In addition, password hashes are stored in SHA1 format, which is a deprecated hashing function.<br><br></td><td>Unauthorised access to the application due to weak authentication mechanisms.<br><br></td><td>High</td><td>It is recommended to make use of stronger authentication mechanisms (i.e. JWT authentication and OIDC authentication) instead of basic authentication. These authentication mechanisms have many advantages, such as the use of short-lived credentials and a central management of security policies through the identity provider.</td></tr><tr><td>EGTM-008</td><td>EGTM-EG-003</td><td>Envoy Gateway</td><td>There is a risk of a threat actor misconfiguring static config and compromising the integrity of Envoy Gateway, ultimately leading to the compromised confidentiality, integrity, or availability of tenant data and cluster resources.<br><br></td><td>Accidental or deliberate misconfiguration of static configuration leads to a misconfigured deployment of Envoy Gateway, for example logging parameters could be modified or global rate limiting configuration misconfigured.<br><br></td><td>Medium</td><td>Implement a GitOps model, utilising Kubernetes' Role-Based Access Control (RBAC) and adhering to the principle of least privilege to minimise human intervention on the cluster. For instance, tools like <a href=https://argo-cd.readthedocs.io/en/stable/>ArgoCD</a> can be used for declarative GitOps deployments, ensuring all changes are tracked and reviewed. Additionally, configure your source control management (SCM) system to include mandatory pull request (PR) reviews, commit signing, and protected branches to ensure only authorised changes can be committed to the start-up configuration.</td></tr><tr><td>EGTM-010</td><td>EGTM-CS-005</td><td>Container Security</td><td>There is a risk that a threat actor exploits a weak pod security context, compromising the CIA of a node and the resources / services which run on it.<br><br></td><td>Threat Actor who has compromised a pod exploits weak security context to escape to a node, potentially leading to the compromise of Envoy Proxy or Gateway running on the same node.<br><br></td><td>Medium</td><td>To mitigate this risk, apply <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/>Pod Security Standards</a> at a minimum of <a href=https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline>Baseline</a> level to all namespaces, especially those containing Envoy Gateway and Proxy Pods. Pod security standards are implemented through K8s <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/>Pod Security Admission</a> to provide <a href=https://kubernetes.io/docs/concepts/security/pod-security-admission/#pod-security-admission-labels-for-namespaces>admission control modes</a> (enforce, audit, and warn) for namespaces. Pod security standards can be enforced by namespace labels as shown <a href=https://kubernetes.io/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/>here</a>, to enforce a baseline level of pod security to specific namespaces.<br><br>Further enhance the security by implementing a sandboxing solution such as <a href=https://gvisor.dev/>gVisor</a> for Envoy Gateway and Proxy Pods to isolate the application from the host kernel. This can be set within the runtimeClassName of the Pod specification.</td></tr><tr><td>EGTM-012</td><td>EGTM-GW-004</td><td>Gateway API</td><td>There is a risk that a threat actor could abuse excessive RBAC privileges to create ReferenceGrant resources. These resources could then be used to create cross-namespace communication, leading to unauthorised access to the application. This could compromise the confidentiality and integrity of resources and configuration in the affected namespaces and potentially disrupt the availability of services that rely on these object references.<br><br></td><td>A ReferenceGrant is created, which validates traffic to cross namespace trust boundaries without a valid business reason, such as a route in one tenant's namespace referencing a backend in another.<br><br></td><td>Medium</td><td>Ensure that the ability to create ReferenceGrant resources is restricted to the minimum number of people. Pay special attention to ClusterRoles that allow that action.</td></tr><tr><td>EGTM-018</td><td>EGTM-GW-006</td><td>Gateway API</td><td>There is a risk that malicious requests could lead to a Denial of Service (DoS) attack, thereby reducing API gateway availability due to misconfigurations in rate-limiting or load balancing controls, or a lack of route timeout enforcement.<br><br></td><td>Reduced API gateway availability due to an attacker's maliciously crafted request (e.g., QoD) potentially inducing a Denial of Service (DoS) attack.<br><br></td><td>Medium</td><td>To ensure high availability and to mitigate potential security threats, adhere to the Envoy Gateway documentation for the configuration of a <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/traffic/global-rate-limit/>rate-limiting</a> filter and load balancing.<br><br>Further, adhere to best practices for configuring Envoy Proxy as an edge proxy documented <a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge#configuring-envoy-as-an-edge-proxy>here</a> within the EnvoyProxy docs. This involves configuring TCP and HTTP proxies with specific settings, including restricting access to the admin endpoint, setting the <a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/operations/overload_manager/overload_manager#config-overload-manager>overload manager</a> and <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/listener/v3/listener.proto#envoy-v3-api-field-config-listener-v3-listener-per-connection-buffer-limit-bytes>listener</a> / <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/cluster/v3/cluster.proto#envoy-v3-api-field-config-cluster-v3-cluster-per-connection-buffer-limit-bytes>cluster</a> buffer limits, enabling <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-use-remote-address>use_remote_address</a>, setting <a href=https://www.envoyproxy.io/docs/envoy/latest/faq/configuration/timeouts#faq-configuration-timeouts>connection and stream timeouts</a>, limiting <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-http2protocoloptions-max-concurrent-streams>maximum concurrent streams</a>, setting <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-http2protocoloptions-initial-stream-window-size>initial stream window size limit</a>, and configuring action on <a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/protocol.proto#envoy-v3-api-field-config-core-v3-httpprotocoloptions-headers-with-underscores-action>headers_with_underscores</a>.<br><br><a href=https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path>Path normalisation</a> should be enabled to minimise path confusion vulnerabilities. These measures help protect against volumetric threats such as Denial of Service (DoS)nattacks. Utilise custom resources to implement policy attachment, thereby exposing request limit configuration for route types.</td></tr><tr><td>EGTM-019</td><td>EGTM-DP-004</td><td>Container Security</td><td>There is a risk that replay attacks using stolen or reused JSON Web Tokens (JWTs) can compromise transmission integrity, thereby undermining the confidentiality and integrity of the data plane.<br><br></td><td>Transmission integrity is compromised due to replay attacks using stolen or reused JSON Web Tokens (JWTs).<br><br></td><td>Medium</td><td>Comply with JWT best practices for enhanced security, paying special attention to the use of short-lived tokens, which reduce the window of opportunity for a replay attack. The <a href=https://datatracker.ietf.org/doc/html/rfc7519#page-9>exp</a> claim can be used to set token expiration times.</td></tr><tr><td>EGTM-024</td><td>EGTM-EG-008</td><td>Envoy Gateway</td><td>There is a risk of developers getting more privileges than required due to the use of SecurityPolicy, ClientTrafficPolicy, EnvoyPatchPolicy and BackendTrafficPolicy. These resources can be attached to a Gateway resource. Therefore, a developer with permission to deploy them would be able to modify a Gateway configuration by targeting the gateway in the policy manifest. This conflicts with the <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#write-permissions-for-advanced-4-tier-model>Advanced 4 Tier Model</a>, where developers do not have write permissions on Gateways.<br><br></td><td>Excessive developer permissions lead to a misconfiguration and/or unauthorised access.<br><br></td><td>Medium</td><td>Considering the Tenant C scenario (represented in the Architecture Diagram), if a developer can create SecurityPolicy, ClientTrafficPolicy, EnvoyPatchPolicy or BackendTrafficPolicy objects in namespace C, they would be able to modify a Gateway configuration by attaching the policy to the gateway. In such scenarios, it is recommended to either:<br><br>a. Create a separate namespace, where developers have no permissions, > to host tenant C's gateway. Note that, due to design decisions, > the > SecurityPolicy/EnvoyPatchPolicy/ClientTrafficPolicy/BackendTrafficPolicy > object can only target resources deployed in the same namespace. > Therefore, having a separate namespace for the gateway would > prevent developers from attaching the policy to the gateway.<br><br>b. Forbid the creation of these policies for developers in namespace C.<br><br>On the other hand, in scenarios similar to tenants A and B, where a shared gateway namespace is in place, this issue is more limited. Note that in this scenario, developers don't have access to the shared gateway namespace.<br><br>In addition, it is important to mention that EnvoyPatchPolicy resources can also be attached to GatewayClass resources. This means that, in order to comply with the Advanced 4 Tier model, individuals with the Application Administrator role should not have access to this resource either.</td></tr><tr><td>EGTM-003</td><td>EGTM-EG-001</td><td>Envoy Gateway</td><td>There is a risk that a threat actor could downgrade the security of proxied connections by configuring a weak set of cipher suites, compromising the confidentiality and integrity of proxied traffic.<br><br></td><td>Exploit weak cipher suite configuration to downgrade security of proxied connections.<br><br></td><td>Low</td><td>Users operating in highly regulated environments may need to tightly control the TLS protocol and associated cipher suites, blocking non-conforming incoming connections to the gateway.<br><br>EnvoyProxy bootstrap config can be customised as per the <a href=/eg-pr-preview/6-test-preview/v1.0/tasks/operations/customize-envoyproxy/>customise EnvoyProxy</a> documentation. In addition, from v.1.0.0, it is possible to configure common TLS properties for a Gateway or XRoute through the <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#clienttrafficpolicy>ClientTrafficPolicy</a> object.</td></tr><tr><td>EGTM-005</td><td>EGTM-CP-002</td><td>Container Security</td><td>Threat actor who has obtained access to Envoy Gateway pod could exploit the lack of AppArmor and Seccomp profiles in the Envoy Gateway deployment to attempt a container breakout, given the presence of an exploitable vulnerability, potentially impacting the confidentiality and integrity of namespace resources.<br><br></td><td>Unauthorised syscalls and malicious code running in the Envoy Gateway pod.<br><br></td><td>Low</td><td>Implement <a href=https://kubernetes.io/docs/tutorials/security/apparmor/>AppArmor</a> policies by setting &lt;container_name>: &lt;profile_ref> within container.apparmor.security.beta.kubernetes.io (note, this config is set <em>per container</em>). Well-defined AppArmor policies may provide greater protection from unknown threats.<br><br>Enforce <a href=https://kubernetes.io/docs/tutorials/security/seccomp/>Seccomp</a> profiles by setting the seccompProfile under securityContext. Ideally, a <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-with-a-seccomp-profile-that-only-allows-necessary-syscalls>fine-grained</a> profile should be used to restrict access to only necessary syscalls, however the --seccomp-default flag can be set to resort to <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile>RuntimeDefault</a> which provides a container runtime specific. Example seccomp profiles can be found <a href=https://kubernetes.io/docs/tutorials/security/seccomp/#download-profiles>here</a>.<br><br>To further enhance pod security, consider implementing <a href=https://en.wikipedia.org/wiki/Security-Enhanced_Linux>SELinux</a> via seLinuxOptions for additional syscall attack surface reduction. Setting readOnlyRootFilesystem == true enforces an immutable root filesystem, preventing the addition of malicious binaries to the PATH and increasing the attack cost. Together, these configuration items improve the pods <a href=https://kubernetes.io/docs/tasks/configure-pod-container/security-context/>Security Context</a>.</td></tr><tr><td>EGTM-006</td><td>EGTM-CS-004</td><td>Container Security</td><td>There is a risk that a threat actor exploits a vulnerability in Envoy Proxy to expose a reverse shell, enabling them to compromise the confidentiality, integrity and availability of tenant data via a secondary attack.<br><br></td><td>If an external attacker managed to exploit a vulnerability in Envoy, the presence of a shell would be greatly helpful for the attacker in terms of potentially pivoting, escalating, or establishing some form of persistence.<br><br></td><td>Low</td><td>By default, Envoy uses a <a href=https://github.com/GoogleContainerTools/distroless>distroless</a> image since v.0.6.0, which does not ship a shell. Therefore, ensure EnvoyProxy image is up-to-date and patched with the latest stable version.<br><br>If using private EnvoyProxy images, use a lightweight EnvoyProxy image without a shell or debugging tool(s) which may be useful for an attacker.<br><br>An <a href=https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/#audit-policy>AuditPolicy</a> (audit.k8s.io/v1beta1) can be configured to record API calls made within your cluster, allowing for identification of malicious traffic and enabling incident response. Requests are recorded based on stages which delineate between the lifecycle stage of the request made (e.g., RequestReceived, ResponseStarted, & ResponseComplete).</td></tr><tr><td>EGTM-011</td><td>EGTM-GW-003</td><td>Gateway API</td><td>There is a risk that a gateway owner (or someone with the ability to set namespace labels) maliciously or accidentally binds routes across namespace boundaries, potentially compromising the confidentiality and integrity of traffic in a multitenant scenario.<br><br></td><td>If a Route Binding within a Gateway Listener is configured based on a custom label, it could allow a malicious internal actor with the ability to label namespaces to change the set of namespaces supported by the Gateway<br><br></td><td>Low</td><td>Consider the use of custom admission control to restrict what labels can be set on namespaces through tooling such as <a href=https://kyverno.io/policies/pod-security/>Kubewarden</a>, <a href=https://github.com/kubewarden>Kyverno</a>, and <a href=https://github.com/open-policy-agent/gatekeeper>OPA Gatekeeper</a>. Route binding should follow the Kubernetes Gateway API security model, as shown <a href=https://gateway-api.sigs.k8s.io/concepts/security-model/#1-route-binding>here</a>, to connect gateways in different namespaces.</td></tr><tr><td>EGTM-013</td><td>EGTM-GW-005</td><td>Gateway API</td><td>There is a risk that an unauthorised actor deploys an unauthorised GatewayClass due to GatewayClass namespace validation not being configured, leading to non-compliance with business and security requirements.<br><br></td><td>Unauthorised deployment of Gateway resource via GatewayClass template which crosses namespace trust boundaries.<br><br></td><td>Low</td><td>Leverage GatewayClass namespace validation to limit the namespaces where GatewayClasses can be run through a tool such as using <a href=https://github.com/open-policy-agent/gatekeeper>OPA Gatekeeper</a>. Reference pull request #<a href=https://github.com/open-policy-agent/gatekeeper-library/pull/24>24</a> within gatekeeper-library which outlines how to add GatewayClass namespace validation through a GatewayClassNamespaces API resource kind within the constraints.gatekeeper.sh/v1beta1 apiGroup.</td></tr><tr><td>EGTM-015</td><td>EGTM-CS-007</td><td>Container Security</td><td>There is a risk that threat actors could exploit ServiceAccount tokens for illegitimate authentication, thereby leading to privilege escalation and the undermining of gateway API resources' integrity, confidentiality, and availability.<br><br></td><td>The threat arises from threat actors impersonating the envoy-gateway ServiceAccount through the replay of ServiceAccount tokens, thereby achieving escalated privileges and gaining unauthorised access to Kubernetes resources.<br><br></td><td>Low</td><td>Limit the creation of ServiceAccounts to only when necessary, specifically refraining from using default service account tokens, especially for high-privilege service accounts. For legacy clusters running Kubernetes version 1.21 or earlier, note that ServiceAccount tokens are long-lived by default. To disable the automatic mounting of the service account token, set automountServiceAccountToken: false in the PodSpec.</td></tr><tr><td>EGTM-016</td><td>EGTM-EG-004</td><td>Envoy Gateway</td><td>There is a risk that threat actors establish persistence and move laterally through the cluster unnoticed due to limited visibility into access and application-level activity.<br><br></td><td>Threat actors establish persistence and move laterally through the cluster unnoticed.<br><br></td><td>Low</td><td>Configure <a href=/eg-pr-preview/6-test-preview/contributions/design/proxy-accesslog/>access logging</a> in the EnvoyProxy. Use <a href=/eg-pr-preview/6-test-preview/v1.0/api/extension_types/#proxyaccesslogformattype>ProxyAccessLogFormatType</a> (Text or JSON) to specify the log format and ensure that the logs are sent to the desired sink types by setting the <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#proxyaccesslogsinktype>ProxyAccessLogSinkType</a>. Make use of <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#fileenvoyproxyaccesslog>FileEnvoyProxyAccessLog</a> or <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#opentelemetryenvoyproxyaccesslog>OpenTelemetryEnvoyProxyAccessLog</a> to configure File and OpenTelemetry sinks, respectively. If the settings aren't defined, the default format is sent to stdout.<br><br>Additionally, consider leveraging a central logging mechanism such as <a href=https://github.com/fluent/fluentd>Fluentd</a> to enhance visibility into access activity and enable effective incident response (IR).</td></tr><tr><td>EGTM-017</td><td>EGTM-EG-005</td><td>Envoy Gateway</td><td>There is a risk that an insider misconfigures an envoy gateway component and goes unnoticed due to a low-touch logging configuration (via default) which responsible stakeholders are not aptly aware of or have immediate access to.<br><br></td><td>The threat emerges from an insider misconfiguring an Envoy Gateway component without detection.<br><br></td><td>Low</td><td>Configure the logging level of the Envoy Gateway using the 'level' field in <a href=https://gateway.envoyproxy.io/latest/api/extension_types/#envoygatewaylogging>EnvoyGatewayLogging</a>. Ensure the appropriate logging levels are set for relevant components such as 'gateway-api', 'xds-translator', or 'global-ratelimit'. If left unspecified, the logging level defaults to "info", which may not provide sufficient detail for security monitoring.<br><br>Employ a centralised logging mechanism, like <a href=https://github.com/fluent/fluentd>Fluentd</a>, to enhance visibility into application-level activity and to enable efficient incident response.</td></tr><tr><td>EGTM-021</td><td>EGTM-EG-006</td><td>Envoy Gateway</td><td>There is a risk that the admin interface is exposed without valid business reason, increasing the attack surface.<br><br></td><td>Exposed admin interfaces give internal attackers the option to affect production traffic in unauthorised ways, and the option to exploit any vulnerabilities which may be present in the admin interface (e.g. by orchestrating malicious GET requests to the admin interface through CSRF, compromising Envoy Proxy global configuration or shutting off the service entirely (e.g., /quitquitquit).<br><br></td><td>Low</td><td>The Envoy Proxy admin interface is only exposed to localhost, meaning that it is secure by default. However, due to the risk of misconfiguration, this recommendation is included.<br><br>Due to the importance of the admin interface, it is recommended to ensure that Envoy Proxies have not been accidentally misconfigured to expose the admin interface to untrusted networks.</td></tr><tr><td>EGTM-025</td><td>EGTM-CS-011</td><td>Container Security</td><td>The presence of a vulnerability, be it in the kernel or another system component, when coupled with containers running as root, could enable a threat actor to escape the container, thereby compromising the confidentiality, integrity, or availability of cluster resources.</td><td>The Envoy Proxy container&rsquo;s root-user configuration can be leveraged by an attacker to escalate privileges, execute a container breakout, and traverse across trust boundaries.</td><td>Low</td><td>By default, Envoy Gateway deployments do not use root users. Nonetheless, in case a custom image or deployment manifest is to be used, make sure Envoy Proxy pods run as a non-root user with a high UID within the container. Set runAsUser and runAsGroup security context options to specific UIDs (e.g., runAsUser: 1000 & runAsGroup: 3000) to ensure the container operates with the stipulated non-root user and group ID. If using helm chart deployment, define the user and group ID in the values.yaml file or via the command line during helm install / upgrade.</td></tr></tbody></table><h2 id=attack-trees>Attack Trees<a class=td-heading-self-link href=#attack-trees aria-label="Heading self-link"></a></h2><p>Attack trees offer a methodical way of describing the security of systems, based on varying attack patterns. It&rsquo;s important to approach the review of attack trees from a top-down perspective. The top node, also known as the root node, symbolises the attacker&rsquo;s primary objective. This goal is then broken down into subsidiary aims, each reflecting a different strategy to attain the root objective. This deconstruction persists until reaching the lowest level objectives or &rsquo;leaf nodes&rsquo;, which depict attacks that can be directly launched.</p><p>It is essential to note that attack trees presented here are speculative paths for potential exploitation. The Envoy Gateway project is in a continuous development cycle, and as the project evolves, new vulnerabilities may be exposed, or additional controls could be introduced. Therefore, the threats illustrated in the attack trees should be perceived as point-in-time reflections of the project’s current state at the time of writing this threat model.</p><h3 id=node-id-schema>Node ID Schema<a class=td-heading-self-link href=#node-id-schema aria-label="Heading self-link"></a></h3><p>Each node in the attack tree is assigned a unique identifier following the AT#-## schema. This allows easy reference to specific nodes in the attack trees throughout the threat model. The first part of the ID (AT#) signifies the attack tree number, while the second part (##) represents the node number within that tree.</p><h3 id=logical-operators>Logical Operators<a class=td-heading-self-link href=#logical-operators aria-label="Heading self-link"></a></h3><p>Logical AND/OR operators are used to represent the relationship between parent and child nodes. An AND operator means that all child nodes must be achieved to satisfy the parent node. An OR operator between a parent node and its child nodes means that any of the child nodes can be achieved to satisfy the parent node.</p><h3 id=attack-tree-node-legend>Attack Tree Node Legend<a class=td-heading-self-link href=#attack-tree-node-legend aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT-legend.png alt="AT Legend"></p><h3 id=at0>AT0<a class=td-heading-self-link href=#at0 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT0.png alt=AT0></p><h3 id=at1>AT1<a class=td-heading-self-link href=#at1 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT1.png alt=AT1></p><h3 id=at2>AT2<a class=td-heading-self-link href=#at2 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT2.png alt=AT2></p><h3 id=at3>AT3<a class=td-heading-self-link href=#at3 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT3.png alt=AT3></p><h3 id=at4>AT4<a class=td-heading-self-link href=#at4 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT4.png alt=AT4></p><h3 id=at5>AT5<a class=td-heading-self-link href=#at5 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT5.png alt=AT5></p><h3 id=at6>AT6<a class=td-heading-self-link href=#at6 aria-label="Heading self-link"></a></h3><p><img src=https://zirain.github.io/eg-pr-preview/6-test-preview//img/AT6.png alt=AT6></p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/envoyproxy/gateway/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/envoyproxy/gateway/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified January 14, 2025: <a href=https://github.com/envoyproxy/gateway/commit/a684c2909e17149f271b3d97953c89d713a659d9>test doc preview (a684c29)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=mailto:envoy-users@googlegroups.com aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/EnvoyProxy aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/envoyproxy/gateway aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Slack aria-label=Slack><a target=_blank rel=noopener href=https://envoyproxy.slack.com/archives/C03E6NHLESV aria-label=Slack><i class="fab fa-slack"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025
<span class=td-footer__authors>The Envoy Gateway Authors</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><p class="td-footer__about mt-2"><a href=/eg-pr-preview/6-test-preview/about/>About Envoy Gateway</a></p></div></div></div></footer></div><script src=/eg-pr-preview/6-test-preview/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin=anonymous></script><script defer src=/eg-pr-preview/6-test-preview/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/eg-pr-preview/6-test-preview/js/tabpane-persist.js></script></body></html>