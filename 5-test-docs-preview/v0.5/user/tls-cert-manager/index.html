<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/eg-pr-preview/5-test-docs-preview/favicons/favicon.ico><link rel=apple-touch-icon href=/eg-pr-preview/5-test-docs-preview/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/eg-pr-preview/5-test-docs-preview/favicons/android-192x192.png sizes=192x192><title>Using cert-manager For TLS Termination | Envoy Gateway</title>
<meta name=description content="This guide shows how to set up cert-manager to automatically create certificates and secrets for use by Envoy Gateway. It will first show how to enable the self-sign issuer, which is useful to test that cert-manager and Envoy Gateway can talk to each other. Then it shows how to use Let&rsquo;s Encrypt&rsquo;s staging environment. Changing to the Let&rsquo;s Encrypt production environment is straight-forward after that.
Prerequisites A Kubernetes cluster and a configured kubectl. The helm command. The curl command or similar for testing HTTPS requests. For the ACME HTTP-01 challenge to work your Gateway must be reachable on the public Internet. the domain name you use (we use www.example.com) must point to the Gateway&rsquo;s external IP(s). Installation Follow the steps from the Quickstart Guide to install Envoy Gateway and the example manifest. Before proceeding, you should be able to query the example backend using HTTP."><meta property="og:url" content="https://zirain.github.io/eg-pr-preview/5-test-docs-preview/v0.5/user/tls-cert-manager/"><meta property="og:site_name" content="Envoy Gateway"><meta property="og:title" content="Using cert-manager For TLS Termination"><meta property="og:description" content="This guide shows how to set up cert-manager to automatically create certificates and secrets for use by Envoy Gateway. It will first show how to enable the self-sign issuer, which is useful to test that cert-manager and Envoy Gateway can talk to each other. Then it shows how to use Let’s Encrypt’s staging environment. Changing to the Let’s Encrypt production environment is straight-forward after that.
Prerequisites A Kubernetes cluster and a configured kubectl. The helm command. The curl command or similar for testing HTTPS requests. For the ACME HTTP-01 challenge to work your Gateway must be reachable on the public Internet. the domain name you use (we use www.example.com) must point to the Gateway’s external IP(s). Installation Follow the steps from the Quickstart Guide to install Envoy Gateway and the example manifest. Before proceeding, you should be able to query the example backend using HTTP."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="v0.5"><meta property="article:modified_time" content="2025-01-12T21:35:44+08:00"><meta itemprop=name content="Using cert-manager For TLS Termination"><meta itemprop=description content="This guide shows how to set up cert-manager to automatically create certificates and secrets for use by Envoy Gateway. It will first show how to enable the self-sign issuer, which is useful to test that cert-manager and Envoy Gateway can talk to each other. Then it shows how to use Let’s Encrypt’s staging environment. Changing to the Let’s Encrypt production environment is straight-forward after that.
Prerequisites A Kubernetes cluster and a configured kubectl. The helm command. The curl command or similar for testing HTTPS requests. For the ACME HTTP-01 challenge to work your Gateway must be reachable on the public Internet. the domain name you use (we use www.example.com) must point to the Gateway’s external IP(s). Installation Follow the steps from the Quickstart Guide to install Envoy Gateway and the example manifest. Before proceeding, you should be able to query the example backend using HTTP."><meta itemprop=dateModified content="2025-01-12T21:35:44+08:00"><meta itemprop=wordCount content="1988"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using cert-manager For TLS Termination"><meta name=twitter:description content="This guide shows how to set up cert-manager to automatically create certificates and secrets for use by Envoy Gateway. It will first show how to enable the self-sign issuer, which is useful to test that cert-manager and Envoy Gateway can talk to each other. Then it shows how to use Let’s Encrypt’s staging environment. Changing to the Let’s Encrypt production environment is straight-forward after that.
Prerequisites A Kubernetes cluster and a configured kubectl. The helm command. The curl command or similar for testing HTTPS requests. For the ACME HTTP-01 challenge to work your Gateway must be reachable on the public Internet. the domain name you use (we use www.example.com) must point to the Gateway’s external IP(s). Installation Follow the steps from the Quickstart Guide to install Envoy Gateway and the example manifest. Before proceeding, you should be able to query the example backend using HTTP."><link rel=preload href=/eg-pr-preview/5-test-docs-preview/scss/main.min.13dd8d11b772c2d11eac755eb5d2d8924f18f01762c20defa026366a1f00937d.css as=style><link href=/eg-pr-preview/5-test-docs-preview/scss/main.min.13dd8d11b772c2d11eac755eb5d2d8924f18f01762c20defa026366a1f00937d.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DXJEH1ZRXX"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DXJEH1ZRXX")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/eg-pr-preview/5-test-docs-preview/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 1200 400"><defs><style>.cls-1{fill:#d04c9b}.cls-2{fill:#4a2365}.cls-3{fill:#b96aab}.cls-4{isolation:isolate}.cls-5{fill:#a53995}</style></defs><g><g id="Layer_1"><g><polygon id="polygon20" class="cls-5" points="191.2 242.29 190.55 213 159.76 193.83 160.4 223.12 191.2 242.29"/><path id="path22" class="cls-5" d="M234.92 315.52l-.65-28.65-26.92-16.8c-.43-.21-.86-.64-1.08-.86l.65 28.86 28 17.45h0z"/><path id="path24" class="cls-5" d="M138.65 354.07l-70.42-43.72-1.73-73.23 34.46-14.86-.65-29.29-55.14 23.69c-4.3 1.94-6.89 5.81-6.67 10.33l2.15 87.87c0 4.53 2.8 9.06 7.11 11.64l84.43 52.33c3.88 2.37 8.61 3.02 12.71 1.94.43-.21.86-.21 1.29-.43l51.9-22.39-28.21-17.45-31.23 13.57h0z"/><path id="path26" class="cls-3" d="M366.29 192.11c-.21-5.17-3.23-10.55-8.39-13.57l-102.52-63.53-3.23 1.29.64 30.8 81.19 50.4 1.94 82.27 31.01 19.17 1.72-.64-2.37-106.18h0z"/><path id="path28" class="cls-3" d="M243.53 336.62l-95.41-59.01-2.37-99.07 43.51-18.74-.86-34.24-67.41 29.07c-4.95 2.16-7.97 6.68-7.75 12.06l2.8 116.3c0 5.38 3.23 10.56 8.4 13.57l111.78 69.35c4.52 2.79 10.12 3.66 14.86 2.15.43-.22.86-.43 1.29-.43l65.9-28.44-32.73-20.25-42 17.67h0z"/><path id="path30" class="cls-1" d="M511.67 110.69 368.45 21.96c-5.38-3.23-11.62-4.1-17-2.37-.44.21-1.08.43-1.51.64L210.16 80.54c-5.6 2.37-9.04 7.54-8.83 13.78l3.44 149.04c.22 6.03 3.88 12.06 9.7 15.51l143.22 88.73c5.17 3.23 11.63 4.09 17.01 2.38.43-.22 1.08-.44 1.51-.65l139.78-60.3c5.59-2.37 9.05-7.75 8.84-13.79l-3.45-149.04c-.21-6.03-3.88-11.85-9.69-15.51M366.08 314.22 241.6 237.11l-3.02-129.44 121.47-52.33 124.49 77.1 3.02 129.45-121.47 52.33h0z"/></g><path id="path10" class="cls-2" d="M607.46 182.14c0 4.62 1.08 9.04 3.23 12.83 2.16 3.78 4.95 7.15 8.18 9.88 3.44 2.74 7.33 4.84 11.84 6.32 4.52 1.47 9.26 2.31 14 2.31 6.46.0 12.27-1.48 17.01-4.41 4.73-2.96 9.26-6.96 13.35-11.79L691 209.07c-11.63 14.71-27.99 22.08-48.88 22.08-8.61.0-16.58-1.47-23.69-4.41-7.11-2.96-13.13-6.95-17.88-12-4.95-5.05-8.61-11.15-11.19-17.88-2.58-6.94-3.88-14.31-3.88-22.51s1.51-15.57 4.31-22.51 6.89-12.83 11.84-17.88 10.98-9.04 18.09-12c6.9-2.94 14.65-4.42 22.83-4.42 9.69.0 18.09 1.69 24.77 5.06 6.67 3.36 12.27 7.77 16.58 13.03 4.31 5.48 7.54 11.37 9.48 18.31 1.94 6.73 3.01 13.67 3.01 20.62v7.37h-88.93v.21h0zM673.78 165.95c-.22-4.63-.86-8.64-2.15-12.42-1.29-3.79-3.23-7.15-6.03-9.89-2.59-2.74-6.02-5.05-9.91-6.53-3.88-1.69-8.61-2.31-13.78-2.31s-9.9 1.05-13.99 2.94c-4.31 1.88-7.97 4.42-10.77 7.36-3.01 2.94-5.17 6.31-6.89 10.1s-2.37 7.37-2.37 10.95h65.89v-.21h0z"/><path id="path12" class="cls-2" d="M714.26 120.71h20.89v16.61h.43c2.58-5.68 7.32-10.52 13.78-13.88 6.46-3.58 14-5.26 22.61-5.26 5.39.0 10.34.84 15.29 2.31 4.95 1.68 9.26 4.01 12.71 7.36 3.66 3.37 6.46 7.57 8.83 12.84 2.16 5.26 3.23 11.36 3.23 18.51v69.44h-20.89v-63.76c0-5.05-.65-9.25-2.15-12.83-1.3-3.58-3.23-6.53-5.6-8.64-2.37-2.1-4.95-3.79-7.97-4.83-3.01-1.06-6.24-1.48-9.47-1.48-4.3.0-8.4.63-12.06 2.1-3.66 1.48-6.89 3.58-9.68 6.53-2.8 2.94-4.96 6.73-6.47 11.35-1.5 4.63-2.37 9.89-2.37 16.21v55.55h-20.88V120.69h-.22v.02z"/><polygon id="polygon14" class="cls-2" points="843.03 120.71 875.98 203.4 907.63 120.71 930.03 120.71 886.74 228.64 863.71 228.64 818.7 120.71 843.03 120.71"/><path id="path16" class="cls-2" d="M931.53 174.77c0-7.78 1.51-15.15 4.53-22.09 3.01-6.73 7.1-12.83 12.49-17.88 5.38-5.06 11.41-9.26 18.73-12.2 7.12-2.95 14.86-4.42 23.04-4.42s15.93 1.47 23.04 4.42c7.1 2.94 13.36 6.93 18.73 12.2 5.17 5.25 9.48 11.15 12.5 17.88 3.01 6.73 4.53 14.1 4.53 22.09s-1.52 15.36-4.53 22.1c-3.02 6.94-7.11 12.83-12.5 17.88-5.37 5.05-11.4 9.04-18.73 12-7.11 2.94-14.85 4.41-23.04 4.41s-15.93-1.47-23.04-4.41c-7.1-2.96-13.35-6.95-18.73-12-5.39-5.05-9.48-11.15-12.49-17.88-3.01-6.94-4.53-14.31-4.53-22.1M953.71 174.77c0 5.47.86 10.52 2.59 15.15 1.71 4.62 4.09 8.62 7.31 11.79 3.02 3.37 6.9 5.89 11.42 7.78 4.52 1.89 9.48 2.94 15.08 2.94s10.55-.84 15.07-2.94c4.51-1.89 8.4-4.41 11.42-7.78 3-3.16 5.59-7.16 7.31-11.79 1.73-4.63 2.59-9.68 2.59-15.15s-.86-10.52-2.59-15.15c-1.71-4.63-4.09-8.63-7.31-11.78-3.02-3.15-6.9-5.89-11.42-7.78-4.52-1.89-9.48-2.94-15.07-2.94s-10.56 1.05-15.08 2.94c-4.52 1.9-8.39 4.42-11.42 7.78-3 3.37-5.59 7.15-7.31 11.78-1.73 4.63-2.59 9.68-2.59 15.15"/><path id="path18" class="cls-2" d="M1050.39 120.71h24.12l32.74 84.15h.42l31.44-84.15h22.4l-52.32 131.07c-1.94 4.63-3.88 9.05-5.82 12.84s-4.31 7.15-7.11 9.88c-2.79 2.73-6.25 4.84-10.12 6.31-3.88 1.48-8.82 2.31-14.43 2.31-3.02.0-6.24-.21-9.48-.62-3.22-.41-6.25-1.26-9.25-2.31l2.58-18.74c4.09 1.69 8.4 2.53 12.49 2.53 3.24.0 6.03-.42 8.18-1.26 2.16-.84 4.09-2.1 5.81-3.58 1.73-1.69 3.03-3.36 4.09-5.46 1.08-2.12 2.15-4.63 3.23-7.37l6.88-17.04-45.86-108.56h0z"/><g class="cls-4"><path class="cls-5" d="M636.86 328.23c0 8.4-2.15 14.77-6.44 19.14-4.3 4.36-10.51 6.54-18.65 6.54-4.53.0-8.61-.66-12.25-1.97s-7.1-3.58-10.38-6.79l5.51-6.3c2.43 2.62 5 4.61 7.72 5.95s5.85 2.02 9.4 2.02 6.25-.51 8.51-1.52c2.26-1.02 4.05-2.4 5.36-4.13 1.31-1.74 2.23-3.72 2.75-5.95.52-2.23.79-4.56.79-6.99v-5.9h-.2c-1.84 2.95-4.23 5.12-7.18 6.49-2.95 1.38-5.97 2.07-9.05 2.07-3.61.0-6.92-.59-9.94-1.77-3.02-1.18-5.61-2.82-7.77-4.92s-3.84-4.59-5.02-7.48c-1.18-2.89-1.77-6.03-1.77-9.45.0-3.74.59-7.12 1.77-10.13 1.18-3.02 2.84-5.56 4.97-7.62 2.13-2.07 4.71-3.66 7.72-4.77 3.02-1.11 6.36-1.67 10.04-1.67 1.57.0 3.15.18 4.72.54s3.1.92 4.58 1.67 2.8 1.71 3.98 2.85c1.18 1.15 2.17 2.48 2.95 3.98h.2v-7.87h7.67v43.98zm-40.34-20.95c0 2.36.43 4.54 1.28 6.54s2.02 3.74 3.49 5.21c1.48 1.48 3.2 2.64 5.17 3.49 1.97.85 4.07 1.28 6.3 1.28 2.62.0 4.95-.46 6.99-1.38 2.03-.92 3.75-2.15 5.17-3.69 1.41-1.54 2.48-3.31 3.2-5.31s1.08-4.12 1.08-6.35c0-2.49-.39-4.77-1.18-6.84s-1.9-3.85-3.34-5.36-3.18-2.67-5.21-3.49c-2.03-.82-4.26-1.23-6.69-1.23s-4.64.44-6.64 1.33c-2 .88-3.71 2.1-5.12 3.64-1.41 1.54-2.51 3.35-3.3 5.41-.79 2.07-1.18 4.31-1.18 6.74z"/><path class="cls-5" d="M650.44 290.16c2.36-2.43 5.17-4.21 8.41-5.36 3.25-1.15 6.54-1.72 9.89-1.72 6.82.0 11.74 1.61 14.76 4.82s4.53 8.1 4.53 14.66v19.78c0 1.31.06 2.67.2 4.08.13 1.41.3 2.71.49 3.89h-7.38c-.26-1.05-.41-2.21-.44-3.49-.03-1.28-.05-2.41-.05-3.39h-.2c-1.51 2.36-3.53 4.3-6.05 5.81-2.53 1.51-5.56 2.26-9.1 2.26-2.36.0-4.58-.29-6.64-.89-2.07-.59-3.87-1.46-5.41-2.61-1.54-1.15-2.77-2.57-3.69-4.28-.92-1.71-1.38-3.67-1.38-5.9.0-3.8.98-6.79 2.95-8.95 1.97-2.16 4.41-3.77 7.33-4.82 2.92-1.05 6.07-1.7 9.45-1.97 3.38-.26 6.48-.39 9.3-.39h2.95v-1.38c0-3.35-1-5.87-3-7.58s-4.81-2.56-8.41-2.56c-2.49.0-4.94.41-7.33 1.23-2.4.82-4.51 2.08-6.35 3.79l-4.82-5.02zM672.67 308.16c-4.92.0-8.82.69-11.71 2.07s-4.33 3.64-4.33 6.79c0 2.89.97 4.94 2.9 6.15s4.34 1.82 7.23 1.82c2.23.0 4.18-.38 5.85-1.13 1.67-.75 3.07-1.75 4.18-3 1.12-1.25 1.97-2.71 2.56-4.38.59-1.67.92-3.46.98-5.36v-2.95h-7.67z"/><path class="cls-5" d="M727.28 290.75H713.7v23.02c0 1.51.03 2.9.1 4.18.06 1.28.33 2.39.79 3.34.46.95 1.15 1.71 2.07 2.26.92.56 2.23.84 3.94.84 1.11.0 2.26-.13 3.44-.39 1.18-.26 2.3-.66 3.35-1.18l.29 6.99c-1.31.59-2.77 1.02-4.38 1.28s-3.13.39-4.58.39c-2.75.0-4.95-.36-6.59-1.08-1.64-.72-2.92-1.74-3.84-3.05-.92-1.31-1.52-2.93-1.82-4.87-.29-1.93-.44-4.08-.44-6.44v-25.29h-10.04v-6.49h10.04v-13.09h7.67v13.09h13.58v6.49z"/><path class="cls-5" d="M777.85 321.94c-2.75 3.54-5.77 6.02-9.05 7.43s-7.08 2.12-11.41 2.12c-3.61.0-6.85-.64-9.74-1.92-2.89-1.28-5.33-3-7.33-5.17s-3.54-4.72-4.62-7.67-1.62-6.1-1.62-9.45c0-3.54.59-6.8 1.77-9.79 1.18-2.98 2.82-5.54 4.92-7.67 2.1-2.13 4.59-3.79 7.48-4.97s6.03-1.77 9.45-1.77c3.21.0 6.17.54 8.86 1.62s5 2.66 6.94 4.72c1.93 2.07 3.43 4.59 4.48 7.58 1.05 2.99 1.57 6.38 1.57 10.18v2.46h-37.19c.13 1.97.61 3.85 1.43 5.66.82 1.81 1.88 3.38 3.2 4.72 1.31 1.35 2.85 2.41 4.62 3.2 1.77.79 3.71 1.18 5.8 1.18 3.35.0 6.17-.59 8.46-1.77 2.29-1.18 4.36-2.92 6.2-5.21l5.8 4.53zM771.26 303.14c-.13-3.94-1.41-7.08-3.84-9.45-2.43-2.36-5.77-3.54-10.04-3.54s-7.71 1.18-10.33 3.54-4.2 5.51-4.72 9.45h28.93z"/><path class="cls-5" d="M840.82 330.3h-7.58l-13.09-35.42h-.2l-11.61 35.42h-7.87l-14.96-46.05h8.46l10.53 35.42h.2l11.91-35.42h8.07l12.1 35.42h.2l10.43-35.42h8.26l-14.86 46.05z"/><path class="cls-5" d="M863.74 290.16c2.36-2.43 5.17-4.21 8.41-5.36 3.25-1.15 6.54-1.72 9.89-1.72 6.82.0 11.74 1.61 14.76 4.82s4.53 8.1 4.53 14.66v19.78c0 1.31.06 2.67.2 4.08.13 1.41.29 2.71.49 3.89h-7.38c-.26-1.05-.41-2.21-.44-3.49-.04-1.28-.05-2.41-.05-3.39h-.2c-1.51 2.36-3.53 4.3-6.05 5.81-2.53 1.51-5.56 2.26-9.1 2.26-2.36.0-4.58-.29-6.64-.89-2.07-.59-3.87-1.46-5.41-2.61-1.54-1.15-2.77-2.57-3.69-4.28-.92-1.71-1.38-3.67-1.38-5.9.0-3.8.98-6.79 2.95-8.95 1.97-2.16 4.41-3.77 7.33-4.82 2.92-1.05 6.07-1.7 9.45-1.97 3.38-.26 6.48-.39 9.3-.39h2.95v-1.38c0-3.35-1-5.87-3-7.58s-4.8-2.56-8.41-2.56c-2.49.0-4.94.41-7.33 1.23-2.4.82-4.51 2.08-6.35 3.79l-4.82-5.02zm22.24 18c-4.92.0-8.82.69-11.71 2.07s-4.33 3.64-4.33 6.79c0 2.89.97 4.94 2.9 6.15s4.34 1.82 7.23 1.82c2.23.0 4.18-.38 5.85-1.13 1.67-.75 3.07-1.75 4.18-3 1.12-1.25 1.97-2.71 2.56-4.38.59-1.67.92-3.46.98-5.36v-2.95h-7.68z"/><path class="cls-5" d="M932.32 340.83c-.79 1.97-1.59 3.75-2.41 5.36-.82 1.61-1.8 2.98-2.95 4.13-1.15 1.15-2.53 2.03-4.13 2.66-1.61.62-3.56.93-5.85.93-1.12.0-2.28-.07-3.49-.2s-2.35-.46-3.39-.98l.98-6.69c.79.33 1.61.54 2.46.64.85.1 1.84.15 2.95.15 2.49.0 4.33-.69 5.51-2.07s2.2-3.21 3.05-5.51l3.15-8.66-19.09-46.34h8.95l14.27 36.11h.2l13.68-36.11h8.36l-22.24 56.57z"/></g></g></g></svg></span><span class=navbar-brand__name>Envoy Gateway</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/eg-pr-preview/5-test-docs-preview/docs><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/5-test-docs-preview/news><span>News</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/5-test-docs-preview/about><span>About</span></a></li><li class=nav-item><a class=nav-link href=/eg-pr-preview/5-test-docs-preview/contributions><span>Contributions</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//latest>latest</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//docs>v1.2</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v1.1>v1.1</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v1.0>v1.0</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v0.6>v0.6</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v0.5>v0.5</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v0.4>v0.4</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v0.3>v0.3</a></li><li><a class=dropdown-item href=https://zirain.github.io/eg-pr-preview/5-test-docs-preview//v0.2>v0.2</a></li></ul></div></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/eg-pr-preview/5-test-docs-preview/zh/>中文</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/eg-pr-preview/5-test-docs-preview/offline-search-index.59545f0114544c87ac67cca9eb52ae6d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/eg-pr-preview/5-test-docs-preview/offline-search-index.59545f0114544c87ac67cca9eb52ae6d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/eg-pr-preview/5-test-docs-preview/zh/>中文</a></li></ul></div></div><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-eg-pr-preview5-test-docs-previewv05-li><a href=/eg-pr-preview/5-test-docs-preview/v0.5/ title="Welcome to Envoy Gateway" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-eg-pr-preview5-test-docs-previewv05><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview5-test-docs-previewv05design-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05design-check>
<label for=m-eg-pr-preview5-test-docs-previewv05design-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview5-test-docs-previewv05design><span>Design</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designgoals-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designgoals-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designgoals-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/goals/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designgoals><span>Goals</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designsystem-design-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designsystem-design-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designsystem-design-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/system-design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designsystem-design><span>System Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designwatching-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designwatching-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designwatching-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/watching/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designwatching><span>Watching Components Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designgatewayapi-translator-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designgatewayapi-translator-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designgatewayapi-translator-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/gatewayapi-translator/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designgatewayapi-translator><span>Gateway API Translator Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designpprof-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designpprof-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designpprof-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/pprof/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designpprof><span>Add Pprof support in Envoy Gateway</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designbootstrap-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designbootstrap-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designbootstrap-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/bootstrap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designbootstrap><span>Bootstrap Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designconfig-api-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designconfig-api-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designconfig-api-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/config-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designconfig-api><span>Configuration API Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designegctl-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designegctl-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designegctl-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/egctl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designegctl><span>egctl Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designextending-envoy-gateway-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designextending-envoy-gateway-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designextending-envoy-gateway-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/extending-envoy-gateway/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designextending-envoy-gateway><span>Envoy Gateway Extensions Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designenvoy-patch-policy-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designenvoy-patch-policy-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designenvoy-patch-policy-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/envoy-patch-policy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designenvoy-patch-policy><span>EnvoyPatchPolicy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designaccesslog-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designaccesslog-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designaccesslog-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/accesslog/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designaccesslog><span>Observability: Accesslog</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designmetrics-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designmetrics-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designmetrics-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/metrics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designmetrics><span>Observability: Metrics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designtracing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designtracing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designtracing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/tracing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designtracing><span>Observability: Tracing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designrate-limit-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designrate-limit-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designrate-limit-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/rate-limit/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designrate-limit><span>Rate Limit Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designrequest-authentication-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designrequest-authentication-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designrequest-authentication-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/request-authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designrequest-authentication><span>Request Authentication Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designlocal-envoy-gateway-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designlocal-envoy-gateway-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designlocal-envoy-gateway-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/local-envoy-gateway/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designlocal-envoy-gateway><span>Running Envoy Gateway locally</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05designtcp-udp-design-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05designtcp-udp-design-check>
<label for=m-eg-pr-preview5-test-docs-previewv05designtcp-udp-design-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/design/tcp-udp-design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05designtcp-udp-design><span>TCP and UDP Proxy Design</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-eg-pr-preview5-test-docs-previewv05user-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05user-check checked>
<label for=m-eg-pr-preview5-test-docs-previewv05user-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview5-test-docs-previewv05user><span>User Guides</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userquickstart-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userquickstart-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userquickstart-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userquickstart><span>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usercustomize-envoyproxy-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usercustomize-envoyproxy-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usercustomize-envoyproxy-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/customize-envoyproxy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usercustomize-envoyproxy><span>Customize EnvoyProxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userdeployment-mode-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userdeployment-mode-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userdeployment-mode-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/deployment-mode/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userdeployment-mode><span>Deployment Mode</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userenvoy-patch-policy-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userenvoy-patch-policy-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userenvoy-patch-policy-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/envoy-patch-policy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userenvoy-patch-policy><span>Envoy Patch Policy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usergateway-address-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usergateway-address-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usergateway-address-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/gateway-address/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usergateway-address><span>Gateway Address</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usergatewayapi-support-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usergatewayapi-support-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usergatewayapi-support-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/gatewayapi-support/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usergatewayapi-support><span>Gateway API Support</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usergrpc-routing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usergrpc-routing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usergrpc-routing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/grpc-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usergrpc-routing><span>GRPC Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-redirect-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-redirect-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-redirect-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-redirect/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-redirect><span>HTTP Redirects</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-headers-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-headers-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-request-headers-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-request-headers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-headers><span>HTTP Request Headers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-response-headers-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-response-headers-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-response-headers-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-response-headers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-response-headers><span>HTTP Response Headers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-routing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-routing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-routing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-routing><span>HTTP Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-urlrewrite-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-urlrewrite-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-urlrewrite-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-urlrewrite/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-urlrewrite><span>HTTP URL Rewrite</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-mirroring-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-mirroring-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-request-mirroring-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-request-mirroring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-request-mirroring><span>HTTPRoute Request Mirroring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userhttp-traffic-splitting-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userhttp-traffic-splitting-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userhttp-traffic-splitting-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/http-traffic-splitting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userhttp-traffic-splitting><span>HTTPRoute Traffic Splitting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userproxy-observability-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userproxy-observability-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userproxy-observability-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/proxy-observability/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userproxy-observability><span>Proxy Observability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userrate-limit-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userrate-limit-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userrate-limit-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/rate-limit/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userrate-limit><span>Rate Limit</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userauthn-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userauthn-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userauthn-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/authn/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userauthn><span>Request Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usersecure-gateways-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usersecure-gateways-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usersecure-gateways-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/secure-gateways/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usersecure-gateways><span>Secure Gateways</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usertcp-routing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usertcp-routing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usertcp-routing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/tcp-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usertcp-routing><span>TCP Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usertls-passthrough-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usertls-passthrough-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usertls-passthrough-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/tls-passthrough/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usertls-passthrough><span>TLS Passthrough</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05usertls-termination-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usertls-termination-check>
<label for=m-eg-pr-preview5-test-docs-previewv05usertls-termination-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/tls-termination/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usertls-termination><span>TLS Termination for TCP</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05userudp-routing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05userudp-routing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05userudp-routing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/udp-routing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05userudp-routing><span>UDP Routing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05useregctl-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05useregctl-check>
<label for=m-eg-pr-preview5-test-docs-previewv05useregctl-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/egctl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05useregctl><span>Use egctl</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-eg-pr-preview5-test-docs-previewv05usertls-cert-manager-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05usertls-cert-manager-check checked>
<label for=m-eg-pr-preview5-test-docs-previewv05usertls-cert-manager-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/tls-cert-manager/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05usertls-cert-manager><span class=td-sidebar-nav-active-item>Using cert-manager For TLS Termination</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview5-test-docs-previewv05install-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05install-check>
<label for=m-eg-pr-preview5-test-docs-previewv05install-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/install/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview5-test-docs-previewv05install><span>Installation</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05installinstall-helm-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05installinstall-helm-check>
<label for=m-eg-pr-preview5-test-docs-previewv05installinstall-helm-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/install/install-helm/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05installinstall-helm><span>Install with Helm</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05installinstall-yaml-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05installinstall-yaml-check>
<label for=m-eg-pr-preview5-test-docs-previewv05installinstall-yaml-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/install/install-yaml/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05installinstall-yaml><span>Install with Kubernetes YAML</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05installinstall-egctl-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05installinstall-egctl-check>
<label for=m-eg-pr-preview5-test-docs-previewv05installinstall-egctl-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/install/install-egctl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05installinstall-egctl><span>Install egctl</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05installapi-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05installapi-check>
<label for=m-eg-pr-preview5-test-docs-previewv05installapi-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/install/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05installapi><span>Helm Chart Values</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview5-test-docs-previewv05api-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05api-check>
<label for=m-eg-pr-preview5-test-docs-previewv05api-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview5-test-docs-previewv05api><span>API</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05apiconfig_types-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05apiconfig_types-check>
<label for=m-eg-pr-preview5-test-docs-previewv05apiconfig_types-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/api/config_types/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05apiconfig_types><span>Config APIs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05apiextension_types-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05apiextension_types-check>
<label for=m-eg-pr-preview5-test-docs-previewv05apiextension_types-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/api/extension_types/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05apiextension_types><span>Extension APIs</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-eg-pr-preview5-test-docs-previewv05contributions-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributions-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributions-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-eg-pr-preview5-test-docs-previewv05contributions><span>Get Involved</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionsroadmap-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionsroadmap-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionsroadmap-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/roadmap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionsroadmap><span>Roadmap</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionsdevelop-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionsdevelop-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionsdevelop-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/develop/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionsdevelop><span>Developer Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionscontributing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionscontributing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionscontributing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/contributing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionscontributing><span>Contributing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionscode_of_conduct-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionscode_of_conduct-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionscode_of_conduct-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/code_of_conduct/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionscode_of_conduct><span>Code of Conduct</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionscodeowners-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionscodeowners-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionscodeowners-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/codeowners/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionscodeowners><span>Maintainers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionsreleasing-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionsreleasing-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionsreleasing-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/releasing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionsreleasing><span>Release Process</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-eg-pr-preview5-test-docs-previewv05contributionsdocs-li><input type=checkbox id=m-eg-pr-preview5-test-docs-previewv05contributionsdocs-check>
<label for=m-eg-pr-preview5-test-docs-previewv05contributionsdocs-check><a href=/eg-pr-preview/5-test-docs-preview/v0.5/contributions/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-eg-pr-preview5-test-docs-previewv05contributionsdocs><span>Working on Envoy Gateway Docs</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/envoyproxy/gateway/tree/main/site/content/en/v0.5/user/tls-cert-manager.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/envoyproxy/gateway/edit/main/site/content/en/v0.5/user/tls-cert-manager.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/envoyproxy/gateway/new/main/site/content/en/v0.5/user?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/envoyproxy/gateway/issues/new?title=Using%20cert-manager%20For%20TLS%20Termination" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/envoyproxy/gateway/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=/eg-pr-preview/5-test-docs-preview/v0.5/user/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#installation>Installation</a></li><li><a href=#deploying-cert-manager>Deploying cert-manager</a></li><li><a href=#a-self-signing-issuer>A Self-Signing Issuer</a></li><li><a href=#creating-a-tls-gateway-listener>Creating a TLS Gateway Listener</a><ul><li><a href=#testing-the-gateway>Testing The Gateway</a></li><li><a href=#how-cert-manager-and-envoy-gateway-interact>How cert-manager and Envoy Gateway Interact</a></li></ul></li><li><a href=#using-the-acme-issuer-with-lets-encrypt-and-http-01>Using the ACME Issuer With Let&rsquo;s Encrypt and HTTP-01</a><ul><li><a href=#testing-the-gateway-1>Testing The Gateway</a></li></ul></li><li><a href=#using-the-lets-encrypt-production-environment>Using The Let&rsquo;s Encrypt Production Environment</a><ul><li><a href=#testing-the-gateway-2>Testing The Gateway</a></li></ul></li><li><a href=#collecting-garbage>Collecting Garbage</a></li><li><a href=#issuer-namespaces>Issuer Namespaces</a></li><li><a href=#using-externaldns>Using ExternalDNS</a></li><li><a href=#monitoring-progress--troubleshooting>Monitoring Progress / Troubleshooting</a></li><li><a href=#clean-up>Clean Up</a></li><li><a href=#see-also>See Also</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/eg-pr-preview/5-test-docs-preview/v0.5/>Documentation</a></li><li class=breadcrumb-item><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/>User Guides</a></li><li class="breadcrumb-item active" aria-current=page>Using cert-manager For TLS Termination</li></ol></nav><div class=td-content><h1>Using cert-manager For TLS Termination</h1><header class=article-meta><p class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>&nbsp; 10 minute read &nbsp;</p></header><p>This guide shows how to set up <a href=https://cert-manager.io/>cert-manager</a> to automatically create certificates and secrets for use by Envoy Gateway.
It will first show how to enable the self-sign issuer, which is useful to test that cert-manager and Envoy Gateway can talk to each other.
Then it shows how to use <a href=https://letsencrypt.org/docs/staging-environment/>Let&rsquo;s Encrypt&rsquo;s staging environment</a>.
Changing to the Let&rsquo;s Encrypt production environment is straight-forward after that.</p><h2 id=prerequisites>Prerequisites<a class=td-heading-self-link href=#prerequisites aria-label="Heading self-link"></a></h2><ul><li>A Kubernetes cluster and a configured <code>kubectl</code>.</li><li>The <code>helm</code> command.</li><li>The <code>curl</code> command or similar for testing HTTPS requests.</li><li>For the ACME HTTP-01 challenge to work<ul><li>your Gateway must be reachable on the public Internet.</li><li>the domain name you use (we use <code>www.example.com</code>) must point to the Gateway&rsquo;s external IP(s).</li></ul></li></ul><h2 id=installation>Installation<a class=td-heading-self-link href=#installation aria-label="Heading self-link"></a></h2><p>Follow the steps from the <a href=../quickstart>Quickstart Guide</a> to install Envoy Gateway and the example manifest.
Before proceeding, you should be able to query the example backend using HTTP.</p><h2 id=deploying-cert-manager>Deploying cert-manager<a class=td-heading-self-link href=#deploying-cert-manager aria-label="Heading self-link"></a></h2><p><em>This is a summary of <a href=https://cert-manager.io/docs/installation/helm/>cert-manager Installation with Helm</a>.</em></p><p>Installing cert-manager is straight-forward, but currently (v1.12) requires setting a feature gate to enable the Gateway API support.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> helm repo add jetstack https://charts.jetstack.io
</span></span><span style=display:flex><span><span style=color:#8f5902>$</span> helm upgrade --install --create-namespace --namespace cert-manager --set <span style=color:#000>installCRDs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> --set <span style=color:#000>featureGates</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>ExperimentalGatewayAPISupport</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> cert-manager jetstack/cert-manager
</span></span></code></pre></div><p>You should now have <code>cert-manager</code> running with nothing to do:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl <span style=color:#204a87>wait</span> --for<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>condition</span><span style=color:#ce5c00;font-weight:700>=</span>Available deployment -n cert-manager --all
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>deployment.apps/cert-manager condition met
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>deployment.apps/cert-manager-cainjector condition met
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>deployment.apps/cert-manager-webhook condition met
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic></span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#8f5902>$</span> kubectl get -n cert-manager deployment
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>cert-manager              1/1     1            1           42m
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>cert-manager-cainjector   1/1     1            1           42m
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>cert-manager-webhook      1/1     1            1           42m
</span></span></span></code></pre></div><h2 id=a-self-signing-issuer>A Self-Signing Issuer<a class=td-heading-self-link href=#a-self-signing-issuer aria-label="Heading self-link"></a></h2><p>cert-manager can have any number of <em>issuer</em> configurations.
The simplest issuer type is <a href=https://cert-manager.io/docs/configuration/selfsigned/>SelfSigned</a>.
It simply takes the certificate request and signs it with the private key it generates for the TLS Secret.</p><pre tabindex=0><code>Self-signed certificates don&#39;t provide any help in establishing trust between certificates.
However, they are great for initial testing, due to their simplicity.
</code></pre><p>To install self-signing, run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl apply -f - &lt;&lt;EOF
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>kind: ClusterIssuer
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>metadata:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  name: selfsigned
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>spec:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  selfSigned: {}
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>EOF
</span></span></span></code></pre></div><h2 id=creating-a-tls-gateway-listener>Creating a TLS Gateway Listener<a class=td-heading-self-link href=#creating-a-tls-gateway-listener aria-label="Heading self-link"></a></h2><p>We now have to patch the example Gateway to reference cert-manager:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl patch gateway/eg --patch <span style=color:#a40000>&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>metadata:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  annotations:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    cert-manager.io/cluster-issuer: selfsigned
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    cert-manager.io/common-name: &#34;Hello World!&#34;
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>spec:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  listeners:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  - name: https
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    protocol: HTTPS
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    hostname: www.example.com
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    port: 443
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    tls:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      mode: Terminate
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      certificateRefs:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      - kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>        name: eg-https
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>&#39; --type=merge
</span></span></span></code></pre></div><p>You could instead create a new Gateway serving HTTPS, if you&rsquo;d prefer.
cert-manager doesn&rsquo;t care, but we&rsquo;ll keep it all together in this guide.</p><p>Nowadays, X.509 certificates don&rsquo;t use the subject Common Name for hostname matching, so you can set it to whatever you want, or leave it empty.
The important parts here are</p><ul><li>the annotation referencing the &ldquo;selfsigned&rdquo; ClusterIssuer we created above,</li><li>the <code>hostname</code>, which is required (but see <a href=https://github.com/cert-manager/cert-manager/issues/6051>#6051</a> for computing it based on attached HTTPRoutes), and</li><li>the named Secret, which is what cert-manager will create for us.</li></ul><p>The annotations are documented in <a href=https://cert-manager.io/docs/usage/gateway/#supported-annotations>Supported Annotations</a>.</p><p>Patching the Gateway makes cert-manager create a self-signed certificate within a few seconds.
Eventually, the Gateway becomes <code>Programmed</code> again:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl <span style=color:#204a87>wait</span> --for<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>condition</span><span style=color:#ce5c00;font-weight:700>=</span>Programmed gateway/eg
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>gateway.gateway.networking.k8s.io/eg condition met
</span></span></span></code></pre></div><h3 id=testing-the-gateway>Testing The Gateway<a class=td-heading-self-link href=#testing-the-gateway aria-label="Heading self-link"></a></h3><p>See <a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/secure-gateways/#testing>Testing in Secure Gateways</a> for the general idea.</p><p>Since we have a self-signed certificate, <code>curl</code> will by default reject it, requiring the <code>-k</code> flag:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> curl -kv -HHost:www.example.com https://127.0.0.1/get
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>* Server certificate:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>*  subject: CN=Hello World!
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>&lt; HTTP/2 200
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span></code></pre></div><h3 id=how-cert-manager-and-envoy-gateway-interact>How cert-manager and Envoy Gateway Interact<a class=td-heading-self-link href=#how-cert-manager-and-envoy-gateway-interact aria-label="Heading self-link"></a></h3><p><em>This explains <a href=https://cert-manager.io/docs/concepts/>cert-manager Concepts</a> in an Envoy Gateway context.</em></p><p>In the interaction between the two, cert-manager does all the heavy lifting.
It subscribes to changes to Gateway resources (using the <a href=https://github.com/cert-manager/cert-manager/tree/master/pkg/controller/certificate-shim/gateways><code>gateway-shim</code> component</a>.)
For any Gateway it finds, it looks for any <a href=https://gateway-api.sigs.k8s.io/guides/tls/#listeners-and-tls>TLS listeners</a>, and the associated <code>tls.certificateRefs</code>.
Note that while Gateway API supports multiple refs here, Envoy Gateway only uses one.
cert-manager also looks at the <code>hostname</code> of the listener to figure out which hosts the certificate is expected to cover.
More than one listener can use the same certificate Secret, which means cert-manager needs to find all listeners using the same Secret before deciding what to do.
If the <code>certificatRef</code> points to a valid certificate, given the hostnames found in listeners, cert-manager has nothing to do.</p><p>If there is no valid certificate, or it is about to expire, cert-manager&rsquo;s <code>gateway-shim</code> creates a Certificate resource, or updates the existing one.
cert-manager then follows the <a href=https://cert-manager.io/docs/concepts/certificate/#certificate-lifecycle>Certificate Lifecycle</a>.
To know how to issue the certificate, an ClusterIssuer is configured, and referenced through annotations on the Gateway resource, which you did above.
Once a matching ClusterIssuer is found, that plugin does what needs to be done to acquire a signed certificate.</p><p>In the case of the ACME protocol (used by Let&rsquo;s Encrypt,) cert-manager can also use an HTTP Gateway to solve the HTTP-01 challenge type.
This is the other side of cert-manager&rsquo;s Gateway API support:
the <a href=https://github.com/cert-manager/cert-manager/tree/master/pkg/issuer/acme/http/httproute.go>ACME issuer</a> creates a temporary <a href=https://gateway-api.sigs.k8s.io/api-types/httproute/>HTTPRoute</a>, lets the ACME server(s) query it, and deletes it again.</p><p>cert-manager then updates the Secret that the Gateway&rsquo;s listener points to in <code>tls.certificateRefs</code>.
Envoy Gateway picks up that the Secret has changed, and reloads the corresponding Envoy Proxy Deployments with the new private key and certificate.</p><p>As you can imagine, cert-manager requires quite broad permissions to update Secrets in any namespace, so the security-minded reader may want to look at the RBAC resources the Helm chart creates.</p><h2 id=using-the-acme-issuer-with-lets-encrypt-and-http-01>Using the ACME Issuer With Let&rsquo;s Encrypt and HTTP-01<a class=td-heading-self-link href=#using-the-acme-issuer-with-lets-encrypt-and-http-01 aria-label="Heading self-link"></a></h2><p>We will start using the Let&rsquo;s Encrypt staging environment, to spare their production environment.
Our Gateway already contains an HTTP listener, so we will use that for the HTTP-01 challenges.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> <span style=color:#000>CERT_MANAGER_CONTACT_EMAIL</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>git config user.email<span style=color:#204a87;font-weight:700>)</span>  <span style=color:#8f5902;font-style:italic># Or whatever...</span>
</span></span><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl apply -f - &lt;&lt;EOF
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>kind: ClusterIssuer
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>metadata:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  name: letsencrypt-staging
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>spec:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  acme:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    server: https://acme-staging-v02.api.letsencrypt.org/directory
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    email: &#34;$CERT_MANAGER_CONTACT_EMAIL&#34;
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    privateKeySecretRef:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      name: letsencrypt-staging-account-key
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    solvers:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    - http01:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>        gatewayHTTPRoute:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>          parentRefs:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>          - kind: Gateway
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>            name: eg
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>            namespace: default
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>EOF
</span></span></span></code></pre></div><p>The important parts are</p><ul><li>using <code>spec.acme</code> with a server URI and contact email address, and</li><li>referencing our plain HTTP gateway so the challenge HTTPRoute is attached to the right place.</li></ul><p>Check the account registration process using the Ready condition:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl <span style=color:#204a87>wait</span> --for<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>condition</span><span style=color:#ce5c00;font-weight:700>=</span>Ready clusterissuer/letsencrypt-staging
</span></span><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl describe clusterissuer/letsencrypt-staging
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>Status:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  Acme:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Uri:                   https://acme-staging-v02.api.letsencrypt.org/acme/acct/123456789
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  Conditions:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Message:               The ACME account was registered with the ACME server
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Reason:                ACMEAccountRegistered
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Status:                True
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Type:                  Ready
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span></code></pre></div><p>Now we&rsquo;re ready to update the Gateway annotation to use this issuer instead:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl annotate --overwrite gateway/eg cert-manager.io/cluster-issuer<span style=color:#ce5c00;font-weight:700>=</span>letsencrypt-staging
</span></span></code></pre></div><p>The Gateway should be picked up by cert-manager, which will create a new certificate for you, and replace the Secret.</p><p>You should see a new CertificateRequest to track:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get certificaterequest
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME             APPROVED   DENIED   READY   ISSUER                REQUESTOR                                         AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>eg-https-xxxxx   True                True    selfsigned            system:serviceaccount:cert-manager:cert-manager   42m
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>eg-https-xxxxx   True                True    letsencrypt-staging   system:serviceaccount:cert-manager:cert-manager   42m
</span></span></span></code></pre></div><h3 id=testing-the-gateway-1>Testing The Gateway<a class=td-heading-self-link href=#testing-the-gateway-1 aria-label="Heading self-link"></a></h3><p>We still require the <code>-k</code> flag, since the Let&rsquo;s Encrypt staging environment CA is not widely trusted.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> curl -kv -HHost:www.example.com https://127.0.0.1/get
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>* Server certificate:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>*  subject: CN=Hello World!
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>*  issuer: C=US; O=(STAGING) Let&#39;s Encrypt; CN=(STAGING) Ersatz Edamame E1
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>&lt; HTTP/2 200
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span></code></pre></div><h2 id=using-the-lets-encrypt-production-environment>Using The Let&rsquo;s Encrypt Production Environment<a class=td-heading-self-link href=#using-the-lets-encrypt-production-environment aria-label="Heading self-link"></a></h2><p>Changing to the production environment is just a matter of replacing the server URI:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> <span style=color:#000>CERT_MANAGER_CONTACT_EMAIL</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>git config user.email<span style=color:#204a87;font-weight:700>)</span>  <span style=color:#8f5902;font-style:italic># Or whatever...</span>
</span></span><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl apply -f - &lt;&lt;EOF
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>apiVersion: cert-manager.io/v1
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>kind: ClusterIssuer
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>metadata:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  name: letsencrypt
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>spec:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  acme:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    server: https://acme-v02.api.letsencrypt.org/directory  # Removed &#34;-staging&#34;.
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    email: &#34;$CERT_MANAGER_CONTACT_EMAIL&#34;
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    privateKeySecretRef:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      name: letsencrypt-account-key                         # Removed &#34;-staging&#34;.
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    solvers:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    - http01:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>        gatewayHTTPRoute:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>          parentRefs:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>          - kind: Gateway
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>            name: eg
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>            namespace: default
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>EOF
</span></span></span></code></pre></div><p>And now you can update the Gateway listener to point to <code>letsencrypt</code> instead:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl annotate --overwrite gateway/eg cert-manager.io/cluster-issuer<span style=color:#ce5c00;font-weight:700>=</span>letsencrypt
</span></span></code></pre></div><p>As before, track it by looking at CertificateRequests.</p><h3 id=testing-the-gateway-2>Testing The Gateway<a class=td-heading-self-link href=#testing-the-gateway-2 aria-label="Heading self-link"></a></h3><p>Once the certificate has been replaced, we should finally be able to get rid of the <code>-k</code> flag:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> curl -v -HHost:www.example.com --resolve www.example.com:127.0.0.1 https://www.example.com/get
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>* Server certificate:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>*  subject: CN=Hello World!
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>*  issuer: C=US; O=Let&#39;s Encrypt; CN=R3
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>&lt; HTTP/2 200
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span></code></pre></div><h2 id=collecting-garbage>Collecting Garbage<a class=td-heading-self-link href=#collecting-garbage aria-label="Heading self-link"></a></h2><p>You probably want to set the <code>cert-manager.io/revision-history-limit</code> annotation on your Gateway to make cert-manager prune the CertificateRequest history.</p><p>cert-manager <a href=https://github.com/cert-manager/cert-manager/blob/c5e6bf39d688d202592318eaf91988466a7ee37b/pkg/controller/certificate-shim/sync.go#L171>deletes unused Certificate resources</a>, and they are updated in-place when possible, so there should be no need for cleaning up Certificate resources.
The deletion is based on whether a Gateway still holds a <code>tls.certificateRefs</code> that requires the Certificate.</p><p>If you remove a TLS listener from a Gateway, you may still have a Secret lingering.
cert-manager can clean it up using <a href=https://cert-manager.io/docs/usage/certificate/#cleaning-up-secrets-when-certificates-are-deleted>a flag</a>.</p><h2 id=issuer-namespaces>Issuer Namespaces<a class=td-heading-self-link href=#issuer-namespaces aria-label="Heading self-link"></a></h2><p>We have used ClusterIssuer resources in this tutorial.
They are not bound to any namespace, and will read annotations from Gateways in any namespace.
You could also use <a href=https://cert-manager.io/docs/concepts/issuer/>Issuer</a>, which is bound to a namespace.
This is useful e.g. if you want to use different ACME accounts for different namespaces.</p><p>If you change the issuer kind, you also need to change the annotation key from <code>cert-manager.io/cluster-issuer</code> to <code>cert-manager.io/issuer</code>.</p><h2 id=using-externaldns>Using ExternalDNS<a class=td-heading-self-link href=#using-externaldns aria-label="Heading self-link"></a></h2><p>The <a href=https://kubernetes-sigs.github.io/external-dns/v0.5.0/>ExternalDNS</a> controller maintains DNS records based on Kubernetes resources.
Together with cert-manager, this can be used to fully automate hostname management.
It can use various source resources, among them Gateway Routes.
Just specify a Gateway Route resource, let ExternalDNS create the domain records, and then cert-manager the TLS certificate.</p><p><a href=https://kubernetes-sigs.github.io/external-dns/v0.5.0/tutorials/gateway-api/>The tutorial on Gateway API</a> uses kubectl.
They also have a <a href=https://github.com/kubernetes-sigs/external-dns/blob/master/charts/external-dns/README.md>Helm chart</a>, which is easier to customize.
The only thing relevant to Envoy Gateway is to set the sources:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># values.yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>sources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>gateway-httproute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>gateway-grpcroute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>gateway-tcproute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>gateway-tlsroute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>gateway-udproute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=monitoring-progress--troubleshooting>Monitoring Progress / Troubleshooting<a class=td-heading-self-link href=#monitoring-progress--troubleshooting aria-label="Heading self-link"></a></h2><p>You can monitor progress in several ways:</p><p>The Issuer has a Ready condition (though this is rather <a href=https://github.com/cert-manager/cert-manager/blob/c5e6bf39d688d202592318eaf91988466a7ee37b/pkg/issuer/selfsigned/setup.go#L32>boring</a> for the <code>selfSigned</code> type):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get issuer --all-namespaces
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAMESPACE   NAME         READY   AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>default     selfsigned   True    42m
</span></span></span></code></pre></div><p>The Gateway will say when it has an invalid certificate:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl describe gateway/eg
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>    Conditions:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Message:               Secret default/eg-https does not exist.
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Reason:                InvalidCertificateRef
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Status:                False
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Type:                  ResolvedRefs
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Message:               Listener is invalid, see other Conditions for details.
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Reason:                Invalid
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Status:                False
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>      Type:                  Programmed
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>Events:
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  Type     Reason     Age    From                       Message
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  ----     ------     ----   ----                       -------
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>  Warning  BadConfig  42m    cert-manager-gateway-shim  Skipped a listener block: spec.listeners[1].hostname: Required value: the hostname cannot be empty
</span></span></span></code></pre></div><p>The main question is if cert-manager has picked up on the Gateway.
I.e., has it created a Certificate for it?
The above <code>describe</code> contains an event from <code>cert-manager-gateway-shim</code> telling you of one such issue.
Be aware that if you have a non-TLS listener in the Gateway, like we did, there will be events saying it is not eligible, which is of course expected.</p><p>Another option is looking at Deployment logs.
The cert-manager logs are not very verbose by default, but setting the Helm value <code>global.logLevel</code> to 6 will enable all debug logs (the default is 2.)
This will make them verbose enough to say why a Gateway wasn&rsquo;t considered (e.g. missing <code>hostname</code>, or <code>tls.mode</code> is not <code>Terminate</code>.)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl logs -n cert-manager deployment/cert-manager
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>...
</span></span></span></code></pre></div><p>Simply listing Certificate resources may be useful, even if it just gives a yes/no answer:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get certificate --all-namespaces
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAMESPACE   NAME       READY   SECRET     AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>default     eg-https   True    eg-https   42m
</span></span></span></code></pre></div><p>If there is a Certificate, then the <code>gateway-shim</code> has recognized the Gateway.
But is there a CertificateRequest for it?
(BTW, don&rsquo;t confuse this with a CertificateSigningRequest, which is a Kubernetes core resource type representing the same thing.)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get certificaterequest --all-namespaces
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAMESPACE   NAME             APPROVED   DENIED   READY   ISSUER       REQUESTOR                                         AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>default     eg-https-xxxxx   True                True    selfsigned   system:serviceaccount:cert-manager:cert-manager   42m
</span></span></span></code></pre></div><p>The ACME issuer also has <code>Order</code> and <code>Challenge</code> resources to watch:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get order --all-namespaces -o wide
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME                                                     STATE     ISSUER                REASON   AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>order.acme.cert-manager.io/envoy-https-xxxxx-123456789   pending   letsencrypt-staging            42m
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic></span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#8f5902>$</span> kubectl get challenge --all-namespaces
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME                                                                    STATE     DOMAIN            AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>challenge.acme.cert-manager.io/envoy-https-xxxxx-123456789-1234567890   pending   www.example.com   42m
</span></span></span></code></pre></div><p>Using <code>kubectl get -o wide</code> or <code>kubectl describe</code> on the Challenge will explain its state more.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get order --all-namespaces -o wide
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME                                                     STATE   ISSUER                REASON   AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>order.acme.cert-manager.io/envoy-https-xxxxx-123456789   valid   letsencrypt-staging            42m
</span></span></span></code></pre></div><p>Finally, since cert-manager creates the Secret referenced by the Gateway listener as its last step, we can also look for that:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#8f5902>$</span> kubectl get secret secret/eg-https
</span></span><span style=display:flex><span><span style=color:#000;font-style:italic>NAME       TYPE                DATA   AGE
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>eg-https   kubernetes.io/tls   3      42m
</span></span></span></code></pre></div><h2 id=clean-up>Clean Up<a class=td-heading-self-link href=#clean-up aria-label="Heading self-link"></a></h2><ul><li>Uninstall cert-manager: <code>helm uninstall --namespace cert-manager cert-manager</code></li><li>Delete the <code>cert-manager</code> namespace: <code>kubectl delete namespace/cert-manager</code></li><li>Delete the <code>https</code> listener from <code>gateway/eg</code>.</li><li>Delete <code>secret/eg-https</code>.</li></ul><h2 id=see-also>See Also<a class=td-heading-self-link href=#see-also aria-label="Heading self-link"></a></h2><ul><li><a href=/eg-pr-preview/5-test-docs-preview/v0.5/user/secure-gateways/>Secure Gateways</a></li><li><a href=https://cert-manager.io/docs/usage/gateway/>Securing gateway.networking.k8s.io Gateway Resources</a></li></ul><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/envoyproxy/gateway/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/envoyproxy/gateway/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified January 12, 2025: <a href=https://github.com/envoyproxy/gateway/commit/c6fe83e666b5ea78a4afd17737ef091509f500e4>baseURL (c6fe83e)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=mailto:envoy-users@googlegroups.com aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/EnvoyProxy aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/envoyproxy/gateway aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Slack aria-label=Slack><a target=_blank rel=noopener href=https://envoyproxy.slack.com/archives/C03E6NHLESV aria-label=Slack><i class="fab fa-slack"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025
<span class=td-footer__authors>The Envoy Gateway Authors</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><p class="td-footer__about mt-2"><a href=/eg-pr-preview/5-test-docs-preview/about/>About Envoy Gateway</a></p></div></div></div></footer></div><script src=/eg-pr-preview/5-test-docs-preview/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin=anonymous></script><script defer src=/eg-pr-preview/5-test-docs-preview/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/eg-pr-preview/5-test-docs-preview/js/tabpane-persist.js></script></body></html>